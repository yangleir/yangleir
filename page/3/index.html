<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://assz0a.coding-pages.com').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="学习笔记">
<meta property="og:url" content="http://assz0a.coding-pages.com/page/3/index.html">
<meta property="og:site_name" content="学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Yang Lei">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://assz0a.coding-pages.com/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>学习笔记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">学习笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">83</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">5</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">142</span></a>

  </li>
        <li class="menu-item menu-item-tools">

    <a href="/tools" rel="section"><i class="fa fa-fw fa-wrench"></i>Tools</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/08/12/altimetry/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/12/altimetry/" class="post-title-link" itemprop="url">卫星测高50年：成就和趋势</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-12 21:05:46 / 修改时间：21:49:34" itemprop="dateCreated datePublished" datetime="2022-08-12T21:05:46+08:00">2022-08-12</time>
            </span>

          
            <span id="/2022/08/12/altimetry/" class="post-meta-item leancloud_visitors" data-flag-title="卫星测高50年：成就和趋势" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/08/12/altimetry/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/08/12/altimetry/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>自1973年<a href="http://www.altimetry.info/missions/past-missions/skylab/" target="_blank" rel="noopener">Skylab-3</a>携带首颗试验性高度计卫星发射升空，已过50年。</p>
<p>50周年之际，国际知名遥感杂志《Remote Sensing》在线发表了中国、希腊等海洋遥感学者撰写的综述论文“Satellite Altimetry: Achievements and Future Trends by a Scientometrics Analysis”。</p>
<p><img src="../images/sa1.png" alt></p>
<p>作者根据SCI数据库<code>Web of Science</code>中收录的近五十年卫星高度计领域的8000余篇科学论文，全面回顾了自上世纪70年代以来，卫星测高走过的发展历程。作者统计了卫星测高的文章年度数量、应用领域分布、研究单位的地理分布特征、卫星测高知识体系网络、作者合作关系、引文共现等，并就前沿领域和今后的发展进行了展望。</p>
<p><img src="../images/sa2.png" alt><br>图1：测高卫星在轨历史</p>
<p>在过去的50年里，卫星测高研究以惊人的速度发展，从最初每年发表不到10篇文献，发展到现在每年发表超过600篇文献，特别是中国学者发表的文献已超过了美国，跃居世界第一位。</p>
<p><img src="../images/sa7.png" alt><br>图2：测高卫星相关研究论文时间演变</p>
<p>研究表明卫星测高的研究领域在不断得到拓展，卫星测高早已不限于传统的海洋学和大地测量学，它已经普遍应用于陆地水文、冰冻圈、陆地地形，甚至森林和土壤监测。经过50年发展，测高精度已得到显著提高，空间/时间分辨率也不断缩小，测高研究的尺度不断向精细化发展。</p>
<p><img src="../images/sa4.png" alt><br>图3：测高卫星研究领域</p>
<p>在全球卫星测高作者集群中，有很多来自我国或华人学者，他们和国内外科学家存在密切的合作，为我国卫星测高的各方面发展做出了突出贡献。</p>
<p><img src="../images/sa5.png" alt><br>图4：测高卫星作者群体</p>
<p>50年间，卫星测高研究热点在逐渐的演变，从早期的雷达高度计理论研究，逐步进化到SAR高度计、GNSS-R，以及新一代宽幅高度计。趋势分析揭示了当前卫星测高的热点研究领域和新的测高技术密切相关。特别是预计将于2022年发射的SWOT任务，将使得卫星测高从“网格”过渡到“像素”分辨率阶段。研究还表明，和人工智能、深度学习等跨领域合作也是未来发展的重点方向之一。</p>
<p><img src="../images/sa6.png" alt><br>图5：测高卫星研究的知识节点</p>
<blockquote>
<p>文章链接：<a href="https://www.mdpi.com/2072-4292/14/14/3332" target="_blank" rel="noopener">https://www.mdpi.com/2072-4292/14/14/3332</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/08/12/pangeo-first/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/12/pangeo-first/" class="post-title-link" itemprop="url">物理海洋大数据云计算入门-Pangeo</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-12 11:50:24" itemprop="dateCreated datePublished" datetime="2022-08-12T11:50:24+08:00">2022-08-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-16 23:39:03" itemprop="dateModified" datetime="2022-08-16T23:39:03+08:00">2022-08-16</time>
              </span>

          
            <span id="/2022/08/12/pangeo-first/" class="post-meta-item leancloud_visitors" data-flag-title="物理海洋大数据云计算入门-Pangeo" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/08/12/pangeo-first/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/08/12/pangeo-first/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><blockquote>
<p>前面已经提到云计算平台pangeo，很多人了解GEE、航天宏图PIE、AWS(亚马逊)、谷歌云地球科学服务等，但pangeo云还是第一听说。小编查阅网络发现，中文资料为零，说明中国的用户确实较少。然而，pangeo云在美欧已发展多年，相关分析工具和云计算已经较为成熟，在地球科学领域，特别是物理海洋领域已经取得很多研究成果。因为这是不错的小众云计算平台，所以特此介绍。今天先聊pangeo入门。</p>
</blockquote>
<p><a href="https://pangeo.io/" target="_blank" rel="noopener">pangeo</a>是由一群草根科学家自发组织的地学大数据云计算系统，它在2016年由美国哥伦比亚大学<a href="https://github.com/rabernat" target="_blank" rel="noopener">Ryan Abernathey</a> 领导的一个物理海洋小组发起，最初是希望更好处理海洋科学大数据，例如MITgcm高分辨模式LLC4320的PB级别数据。通过数年时间，大批参与者通过github平台发展了一系列的大数据和云计算分析软件，搭建了pangeo云计算基础设施，形成了良好的科学生态系统（如JupyterHub、dask、xarray、intake、Zarr等）。这几年，pangeo云计算已在一定程度上改变了地球科学的研究方式，它提高了科学生产力，使研究结果可重复，也为数据密集型问题的研究打开新大门。</p>
<p>pangeo得到了美国NSF EarthCube计划、Anaconda、NASA、NCAR以及一些私人基金会的强力资助，使之能够持续发展。目前pangeo为全世界用户免费提供云计算服务（最大16CPU，60G内存）。</p>
<h3 id="云计算和传统科研模式的区别"><a href="#云计算和传统科研模式的区别" class="headerlink" title="云计算和传统科研模式的区别"></a>云计算和传统科研模式的区别</h3><p>我们先欣赏下传统的数据下载模式，以著名的欧洲Climate Data Store (CDS) 分发ECMWF ERA5资料为例，视频是CDS数据中心的机器人插卡作业模式，如果你申请这里的数据，机器人的机械手臂会把磁带接口插入相关卡槽读取数据，完成后再提供下载服务：</p>
<video id="video" controls preload="none">
    <source id="mp4" src="/images/era5.mp4" type="video/mp4">
</video>
<center>Climate Data Store (CDS) @ECMWF的机器人插卡作业模式</center>

<p>云计算离不开云数据。pangeo将大量数据存储于商业云平台，并购买数据中心附近的计算机算力资源，由这些算力来计算靠近它的云数据，因此数据读相当快。而云计算的计算能力则和费用相关。由于pangeo为免费服务，因此算力不能和超算媲美，但通过结合dask集群，计算能力足够强大。</p>
<p>Pangeo云架构：<br><img src="../images/yun.png" alt></p>
<h2 id="注册使用"><a href="#注册使用" class="headerlink" title="注册使用"></a>注册使用</h2><p>因为是云计算，需要注册一个账号。</p>
<blockquote>
<p><a href="https://pangeo.io/cloud.html" target="_blank" rel="noopener">https://pangeo.io/cloud.html</a></p>
</blockquote>
<p>Pangeo Cloud目前包含两个不同的计算集群：</p>
<ul>
<li>us-central1-b.gcp.pangeo.io 谷歌云平台。</li>
<li>aws-uswest2.pangeo.io AWS集群。</li>
</ul>
<p>建议根据您要访问的数据选择集群。例如，如果您的数据主要存在于AWS中，请选择aws-uswest2。经Pangeo管理员审查同意之后，加入Pangeo的Github小组，便可以使用Pangeo云。（需要有一个Github账号，并对Git有一定的了解）</p>
<p>Pangeo Cloud集群为用户提供不同数量的RAM和CPU，可以在登录时进行设置。请为根据工作需要选择资源最少的设施，因为更大的内存和cpu会花费更多的钱。 是的，云计算本质上是收费服务，这部分钱由美国NSF等基金支付了。</p>
<h2 id="云数据初探"><a href="#云数据初探" class="headerlink" title="云数据初探"></a>云数据初探</h2><p>几十年来，地球科学领域一直采用“下载模式”分析数据，即科学家从远程FTP服务器下载数据到个人电脑。而Pangeo的理念是将计算带到云数据中，这也就是云计算。Pangeo提供靠近高性能存储的高性能计算集群，目前许多广泛使用的数据集已经存储在这些云上。</p>
<p>如果对分析特定的大型数据集感兴趣，应该首先确定此数据集是否已存储在现有的云端，然后，可以请求访问该特定云数据以执行计算分析。或者，如果您的实验室或小组已经维护了一个数据存储库，也可以考虑在本地计算资源上部署Pangeo环境数据服务器（可能比较费力）。 </p>
<p>使用云数据和云计算无需掌握很多特殊知识，但需要能够熟练使用一下基础工具：</p>
<ul>
<li>Jupyter Hub</li>
<li>Python</li>
<li>Xarray</li>
</ul>
<p>当前，许多预存数据集目录都位于catalog.pangeo.io。此目录已预先配置，包含海洋、大气、气候和水文等不同类型数据。在大多数情况下，调取云数据很简单：</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">from</span> <span class="variable">intake</span> <span class="variable">import</span> <span class="variable">open_catalog</span></span><br><span class="line"></span><br><span class="line"><span class="variable">cat</span> = <span class="function"><span class="title">open_catalog</span>(<span class="string">"https://raw.githubusercontent.com/pangeo-data/pangeo-datastore/master/intake-catalogs/master.yaml"</span>)</span></span><br><span class="line"><span class="function"><span class="title">list</span>(<span class="variable">cat</span>)</span></span><br></pre></td></tr></table></figure>
<p>[‘ocean’, ‘atmosphere’, ‘climate’, ‘hydro’]</p>
<blockquote>
<p>这些数据集合中包含了CESM全球气候模式、NCAR数据集、CCMP、极地数据、Landsat8数据、CMIP6、卫星测高沿轨和网格数据、MOM6/CESM、MITgcm ECCOv4、LLC4320、ESIP等资料。</p>
</blockquote>
<p>此外，还可以利用<code>fsspec</code>打开目录之外的数据,例如，要从Google Cloud Storage打开公共文件cmpi6，您可以执行以下操作： </p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> fsspec</span><br><span class="line"><span class="built_in">path</span> = <span class="string">'gs://cmip6/cmip6-zarr-consolidated-stores.csv'</span></span><br><span class="line"><span class="keyword">with</span> fsspec.open(<span class="built_in">path</span>) <span class="keyword">as</span> f:</span><br><span class="line">    df = pd.read_csv(f)</span><br></pre></td></tr></table></figure>

<h4 id="物理海洋数据集"><a href="#物理海洋数据集" class="headerlink" title="物理海洋数据集"></a>物理海洋数据集</h4><p>物理海洋数据集是pangeo的重点，通过命令<code>open_catalog</code>可以很方便的打开它，该数据集合包含了多种常见的数据，比如卫星高度计的沿轨和网格数据、多种高分模式数据等，还有前面提到的MITgcm LLC4320模式数据。LLC4320数据由于存储巨大，它几乎只能在超级计算机或者Pangeo云端使用。</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">cat</span> = <span class="function"><span class="title">open_catalog</span>(<span class="string">"https://raw.githubusercontent.com/pangeo-data/pangeo-datastore/master/intake-catalogs/ocean.yaml"</span>)</span></span><br><span class="line"><span class="function"><span class="title">list</span>(<span class="variable">cat</span>)</span></span><br></pre></td></tr></table></figure>
<p>[‘sea_surface_height’,<br> ‘cesm_mom6_example’,<br> ‘ECCOv4r3’,<br> ‘SOSE’,<br> ‘GODAS’,<br> ‘ECCO_layers’,<br> ‘altimetry’,<br> ‘LLC4320’,<br> ‘GFDL_CM2_6’,<br> ‘CESM_POP’,<br> ‘channel’,<br> ‘MEOM_NEMO’]</p>
<p>我们先用简单的SSH数据为例，介绍怎么读取、制图、计算和保存。<br>读取命令为<code>to_dask()</code>，这一步为lazy计算，并未真的计算:</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ds</span>  = <span class="keyword">cat</span>[<span class="string">"sea_surface_height"</span>].to_dask()</span><br><span class="line"><span class="keyword">ds</span></span><br></pre></td></tr></table></figure>
<p>SSH数据中包含了sla、adt、流速等信息。</p>
<p><img src="../images/pangeo1.png" alt></p>
<p>看一下sla的数据结构和大小，超过68G：</p>
<p><img src="../images/pangeo2.png" alt></p>
<p>这时候数据已经是常见的xarray格式，通过<code>isel</code>选择一个时间：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds.sla.isel(<span class="attribute">time</span>=0)</span><br></pre></td></tr></table></figure>

<p><img src="../images/pangeo3.png" alt></p>
<p>使用xarray的<code>.plot()</code>函数进行绘图，这时候数据才真正的调入内存：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds.sla.isel(time=<span class="number">0</span>).plot(figsize=(<span class="number">15</span>, <span class="number">7</span>))</span><br></pre></td></tr></table></figure>

<p><img src="../images/pangeo4.png" alt></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds.sla.sel(time=<span class="string">"1993-01-07"</span>,latitude=slice(<span class="number">-60</span>,<span class="number">-20</span>),longitude=slice(<span class="number">0</span>,<span class="number">50</span>)).plot()</span><br></pre></td></tr></table></figure>
<p><img src="../images/pangeo5.png" alt></p>
<p>使用xarray的<code>to_netcdf()</code>保存nc数据格式到本地。通常我们只保存数据计算结果，原始数据和中间数据的保存没有太大意义。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds.sel(time=<span class="string">"1993-01-07"</span>,latitude=slice(<span class="number">-60</span>,<span class="number">-20</span>),longitude=slice(<span class="number">0</span>,<span class="number">50</span>)).to_netcdf(<span class="string">"ssh.nc"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="大数据并行计算"><a href="#大数据并行计算" class="headerlink" title="大数据并行计算"></a>大数据并行计算</h2><p>上面仅展示单独数据文件的读取、绘图和保存，数据体积小，无需大数据的相关并行运算。如果数据量较大，比如使用全部的sla数据计算全球海平面变化，则一共需要读取68G的数据，这时候可能需要集群的并行计算配置。pangeo通过融合dask可以实现集群计算。</p>
<blockquote>
<p>Dask 是 Pangeo Cloud 的重要组件，可用于并行化的大型计算。pangeo用户无需太多并行计算知识即可使用它，但由于Dask能够使用许多云计算节点，大型、长时间运行、空闲的集群将会浪费Pangeo有限的云计算资金。因此请谨慎使用此力量！ </p>
</blockquote>
<p>要使用Dask进行可扩展计算，您需要使用Dask Gateway创建一个集群并连接到它 </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dask_gateway import GatewayCluster</span><br><span class="line"><span class="keyword">from</span> dask.distributed import Client</span><br><span class="line">cluster = GatewayCluster()</span><br><span class="line">cluster.scale(5)</span><br><span class="line">client = Client(cluster)</span><br><span class="line">cluster</span><br></pre></td></tr></table></figure>

<p>完成计算后，您可以显式关闭集群</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cluster</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure>
<video id="video" controls preload="none">
    <source id="mp4" src="/images/pangeodask.mp4" type="video/mp4">
</video>
<center>dask监控界面</center>

<h3 id="海平面变化时间序列"><a href="#海平面变化时间序列" class="headerlink" title="海平面变化时间序列"></a>海平面变化时间序列</h3><p>计算全球海平面变化并不复杂，主要是均值的计算。首先沿着经纬度计算均值，并载入内存：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sla_timeseries</span> = ds.sla.mean(dim=(<span class="string">'latitude'</span>, <span class="string">'longitude'</span>)).load()</span><br></pre></td></tr></table></figure>
<p>该集群计算启动了5个worker，10个线程，大约1分半处理完数据，计算得到全球的平均海平面变化时间序列:</p>
<p>绘图：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">sla_timeseries</span><span class="selector-class">.plot</span>(label=<span class="string">'full data'</span>)</span><br><span class="line"><span class="selector-tag">sla_timeseries</span><span class="selector-class">.rolling</span>(time=<span class="number">365</span>, center=True)<span class="selector-class">.mean</span>()<span class="selector-class">.plot</span>(label=<span class="string">'rolling annual mean'</span>)</span><br><span class="line"><span class="selector-tag">plt</span><span class="selector-class">.ylabel</span>(<span class="string">'Sea Level Anomaly [m]'</span>)</span><br><span class="line"><span class="selector-tag">plt</span><span class="selector-class">.title</span>(<span class="string">'Global Mean Sea Level'</span>)</span><br><span class="line"><span class="selector-tag">plt</span><span class="selector-class">.legend</span>()</span><br><span class="line"><span class="selector-tag">plt</span><span class="selector-class">.grid</span>()</span><br></pre></td></tr></table></figure>

<p><img src="../images/pangeo6.png" alt></p>
<blockquote>
<p>本质上，SSH数据并不算大数据，只是比较大。这里仅展示其工作流程。</p>
</blockquote>
<h3 id="纬向变化时间特征"><a href="#纬向变化时间特征" class="headerlink" title="纬向变化时间特征"></a>纬向变化时间特征</h3><p>还可以计算纬向SLA变化,即在经度方向计算均值，耗时大约2分钟：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sla_hov = ds.sla.mean(<span class="attribute">dim</span>=<span class="string">'longitude'</span>).load()</span><br><span class="line">fig, ax = plt.subplots(figsize=(12, 4))</span><br><span class="line">sla_hov.name = <span class="string">'Sea Level Anomaly [m]'</span></span><br><span class="line">sla_hov.transpose().plot(<span class="attribute">vmax</span>=0.2, <span class="attribute">ax</span>=ax)</span><br></pre></td></tr></table></figure>

<p>我们可以看到海平面变化的纬向特征：<br><img src="../images/pangeo7.png" alt></p>
<h3 id="空间变化特征"><a href="#空间变化特征" class="headerlink" title="空间变化特征"></a>空间变化特征</h3><p>可以通过STD来计算全球海平面变化的空间特征:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sla_std</span> = ds.sla.std(dim=<span class="string">'time'</span>).load()</span><br><span class="line"><span class="attr">sla_std.name</span> = <span class="string">'Sea Level Variability [m]'</span></span><br><span class="line"><span class="attr">ax</span> = sla_std.plot(figsize=(<span class="number">20</span>, <span class="number">12</span>))</span><br><span class="line"><span class="attr">_</span> = plt.title(<span class="string">'Sea Level Variability'</span>)</span><br></pre></td></tr></table></figure>
<p>在流场较强的海域，variability是比较大的，比如西边界流、南极绕极流等：<br><img src="../images/pangeo8.png" alt></p>
<h3 id="KE计算"><a href="#KE计算" class="headerlink" title="KE计算"></a>KE计算</h3><p>接下来，以南大洋绕极流为例，计算KE的长时间平均，这里的计算稍微加强一点，但也不复杂：</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ds_SO = ds.sel(latitude=slice(-<span class="number">90</span>, -<span class="number">30</span>))</span><br><span class="line">meanSSH = ds_SO.adt.<span class="built_in">mean</span>('<span class="built_in">time</span>')</span><br><span class="line">meanSSH.<span class="built_in">load</span>()</span><br><span class="line">EKE = <span class="number">0.5</span>*(ds_SO.ugosa**<span class="number">2</span> + ds_SO.vgosa**<span class="number">2</span>).<span class="built_in">mean</span>('<span class="built_in">time</span>') # KE</span><br><span class="line">EKE.<span class="built_in">load</span>() </span><br><span class="line">MKE = <span class="number">0.5</span>*( (ds_SO.ugos - ds_SO.ugosa)**<span class="number">2</span> + (ds_SO.vgos - ds_SO.vgosa)**<span class="number">2</span>).<span class="built_in">mean</span>('<span class="built_in">time</span>') # MKE (<span class="built_in">mean</span>)</span><br><span class="line">MKE.<span class="built_in">load</span>()</span><br></pre></td></tr></table></figure>

<p>绘图：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(16,5))</span><br><span class="line">np.log10(EKE).plot.contourf(<span class="attribute">vmin</span>=-3.5, <span class="attribute">vmax</span>=-0.7, <span class="attribute">levels</span>=10)</span><br><span class="line">meanSSH.plot.contour(<span class="attribute">levels</span>=15, <span class="attribute">linewidths</span>=0.75)</span><br></pre></td></tr></table></figure>
<p><img src="../images/pangeo9.png" alt></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(16,5))</span><br><span class="line">np.log10(MKE).plot.contourf(<span class="attribute">vmin</span>=-3.5, <span class="attribute">vmax</span>=-0.7, <span class="attribute">levels</span>=9)</span><br><span class="line">meanSSH.plot.contour(<span class="attribute">levels</span>=15, <span class="attribute">linewidths</span>=0.5)</span><br></pre></td></tr></table></figure>
<p><img src="../images/pangeo10.png" alt></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>通过注册，得到一个有效的云计算账户，然后初次尝试pangeo计算全球海平面变化，以及局部海域的动量特征，我们可以总结它的特色为：</p>
<ul>
<li>降低大数据编程的精力投入，增强宏观科学问题的思考</li>
<li>降低集群分析门槛，无需专门的并行计算和云计算知识</li>
<li>无需数据下载，按需调取海量云数据集</li>
<li>开源支持，生态系统完备可持续</li>
</ul>
<p>目前，GEE等云计算和大数据平台已经较为普及，但GEE等平台专注于图像遥感，无法接入物理海洋、大气科学等数据（模式和观测等）。pangeo云计算则在一定程度填补了这些空白，它发源于草根群体，在美国一步步发展壮大，获得NSF等机构数百万美元的资助，得到了美国政府和科学界的认可，小编认为这必然是未来海洋、大气科学的重点发展方向之一。国内在该领域暂时是空白的（大部分人无法访问pangeo和谷歌云服务），未来几年国内将可预见的在海洋、大气云计算领域快速增长。</p>
<h2 id="下节预告"><a href="#下节预告" class="headerlink" title="下节预告"></a>下节预告</h2><ul>
<li>基于云计算的LLC4320海洋模式数据谱分析</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/08/02/llc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/02/llc/" class="post-title-link" itemprop="url">LLCreader开源程序读取LLC4320模式数据</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-02 12:22:21 / 修改时间：12:56:56" itemprop="dateCreated datePublished" datetime="2022-08-02T12:22:21+08:00">2022-08-02</time>
            </span>

          
            <span id="/2022/08/02/llc/" class="post-meta-item leancloud_visitors" data-flag-title="LLCreader开源程序读取LLC4320模式数据" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/08/02/llc/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/08/02/llc/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="LLC4320模式简介"><a href="#LLC4320模式简介" class="headerlink" title="LLC4320模式简介"></a>LLC4320模式简介</h3><p>LLC4320是MITgcm 1/48°模式资料，其直接的诞生原因是帮助海洋学家为即将到来的SWOT任务将以前所未有的分辨率观察海洋表面。</p>
<p>该模拟在几个方面具有开创性，特别是其高空间分辨率（全球覆盖范围在 1 到 2 公里之间）、综合潮汐驱动和高频（每小时）输出，其海面高度信号中包含了内潮、内波、地转平衡等信号。除了在SWOT相关模拟工作取得应用之外，该模式也在海洋亚中尺度方向得到了很多应用，</p>
<p>该模式主要特征是：</p>
<ul>
<li>全球覆盖（包含极地）</li>
<li>垂向90层</li>
<li>分辨率1/48°</li>
<li>全球海洋分成13个face。每个face的网格数为4320*4320.</li>
<li>时间采样是小时，总计时间维度9030</li>
<li>共14 个月（2011 年 9 月至 2012 年 11 月）</li>
<li>数据量巨大，PB级别</li>
<li>以MDS自定义二进制数据格式存储，为MITgcm独有</li>
<li>模型网格复杂，为lat-lon-cap (LLC) 曲线网格 ，很难在常规地图投影中可视化。</li>
</ul>
<p>在数据发布之初，该数据集位于高度安全的NASA超级计算机上，只有获得NASA资助的研究人员才能访问。</p>
<p>后来，NASA Ames研究中心创建数据共享网站（<a href="https://data.nas.nasa.gov/ecco/），开放了LLC4320数据。" target="_blank" rel="noopener">https://data.nas.nasa.gov/ecco/），开放了LLC4320数据。</a><br>任何人都可以通过该门户通过互联网访问数据。在此网站上，您可以单击以下载单个大小40GB的二进制文件。但是，除非您知道如何解码其中的内容，否则这些文件毫无用处。</p>
<h3 id="xmitgcm-llcreader"><a href="#xmitgcm-llcreader" class="headerlink" title="xmitgcm.llcreader"></a>xmitgcm.llcreader</h3><blockquote>
<p>xmitgcm 是一个 python 包，用于将 MITgcm 二进制 MDS 文件读入 xarray 数据结构。 通过将数据存储在 dask 数组中，xmitgcm 可以实现并行计算。</p>
</blockquote>
<blockquote>
<p>代码库: <a href="https://github.com/MITgcm/xmitgcm" target="_blank" rel="noopener">https://github.com/MITgcm/xmitgcm</a><br>文档: <a href="https://xmitgcm.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://xmitgcm.readthedocs.io/en/latest/</a><br>博客: <a href="https://medium.com/pangeo/petabytes-of-ocean-data-part-1-nasa-ecco-data-portal-81e3c5e077be" target="_blank" rel="noopener">https://medium.com/pangeo/petabytes-of-ocean-data-part-1-nasa-ecco-data-portal-81e3c5e077be</a></p>
</blockquote>
<p>为了使二进制数据方便利用，Ryan Abernathey等开发了xmitgcm的python包，其中llcreader用于读取这些二进制文件。该模块使用xarray和dask从ECCO数据门户网站在线访问数据，使模式大数据的操作变得轻而易举。</p>
<h3 id="海面温度读取示例"><a href="#海面温度读取示例" class="headerlink" title="海面温度读取示例"></a>海面温度读取示例</h3><p>以海面高度读取为例，展示其基本操作。用到了如下库：</p>
<ul>
<li>xmitgcm: 提供llcreader</li>
<li>xarray: 基本数据结构和操作</li>
<li>dask: 大数据并行和lazy计算</li>
<li>sholoviews: 交互式的图像展示</li>
</ul>
<h4 id="1导入库"><a href="#1导入库" class="headerlink" title="1导入库"></a>1导入库</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xmitgcm.llcreader <span class="keyword">as</span> llcreader</span><br><span class="line">%matplotlib <span class="keyword">inline</span></span><br><span class="line"><span class="keyword">import</span> holoviews <span class="keyword">as</span> hv</span><br><span class="line"><span class="keyword">from</span> holoviews.operation.datashader <span class="keyword">import</span> regrid</span><br><span class="line">hv.<span class="keyword">extension</span>(<span class="string">'bokeh'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><p>这里我们使用LLC4320模式数据：</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">model</span> = llcreader.ECCOPortalLLC4320Model()</span><br><span class="line"><span class="keyword">model</span></span><br></pre></td></tr></table></figure>

<p>更具数据分辨率和来源，llcreader 可用模块有：</p>
<ul>
<li><code>llcreader.ECCOPortalLLC2160Model</code>: LLC2160 accessed via ECCO data portal</li>
<li><code>llcreader.ECCOPortal LLC4320Model</code>: LLC4320 accessed via ECCO data portal</li>
<li><code>llcreader.PleiadesLLC2160Model</code>: LLC2160 accessed on Pleaides filesystem</li>
<li><code>llcreader.PleiadesLLC4320Model</code>: LLC4320 accessed on Pleaides filesystem</li>
<li><code>llcreader.CRIOSPortalASTE270Model</code>: ASTE Release 1 accessed via AWS</li>
<li><code>llcreader.SverdrupASTE270Model</code>: ASTE Release 1 accessed on Sverdrup filesystem at UT Austin</li>
</ul>
<h4 id="海表温度"><a href="#海表温度" class="headerlink" title="海表温度"></a>海表温度</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ds_sst = model.get<span class="constructor">_dataset(<span class="params">varnames</span>=['Theta'], <span class="params">k_levels</span>=[0], <span class="params">type</span>='<span class="params">latlon</span>')</span></span><br><span class="line">ds_sst</span><br></pre></td></tr></table></figure>
<p>这里的<code>Theta</code>是模式中固有的海表温度名称。这一行程序执行的lazy模式，数据并没有存储在本地内存，也不会进行计算。该变量的大小接近10T。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds_sst.nbytes / <span class="number">1e12</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>9.257148163328</p>
</blockquote>
<p>如果想查看其他变量的名称：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">print</span><span class="params">(model.varnames)</span></span></span><br></pre></td></tr></table></figure>

<p>[‘Eta’, ‘KPPhbl’, ‘oceFWflx’, ‘oceQnet’, ‘oceQsw’, ‘oceSflux’, ‘oceTAUX’, ‘oceTAUY’, ‘PhiBot’, ‘Salt’, ‘SIarea’, ‘SIheff’, ‘SIhsalt’, ‘SIhsnow’, ‘SIuice’, ‘SIvice’, ‘Theta’, ‘U’, ‘V’, ‘W’]</p>
<p>比如<code>Eta</code>表示海面高度，<code>U,V,W</code>为速度，在数据操作的进行变量替换。<br><code>get_dataset</code>模块的全部参数设置为</p>
<blockquote>
<p>get_dataset(varnames=None, iter_start=None, iter_stop=None, iter_step=None, iters=None, k_levels=None, k_chunksize=1, type=’faces’, read_grid=True, grid_vars_to_coords=True)</p>
</blockquote>
<p>常见操作有：</p>
<ul>
<li>ds = model.get_dataset(varnames=[‘Eta’])</li>
<li>ds = model.get_dataset(varnames=[‘Salt’, ‘Theta’], k_levels=[1, 10, 40])</li>
<li>ds = model.get_dataset(varnames=[‘Theta’], k_levels=[0], type=’latlon’)</li>
</ul>
<blockquote>
<p>参考：<a href="https://xmitgcm.readthedocs.io/en/latest/llcreader.html#xmitgcm.llcreader.BaseLLCModel.get_dataset" target="_blank" rel="noopener">https://xmitgcm.readthedocs.io/en/latest/llcreader.html#xmitgcm.llcreader.BaseLLCModel.get_dataset</a></p>
</blockquote>
<h4 id="动态交互可视化"><a href="#动态交互可视化" class="headerlink" title="动态交互可视化"></a>动态交互可视化</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dataset = hv.Dataset(ds_sst.Theta.isel(<span class="attribute">k</span>=0).astype('f4'))</span><br><span class="line">hv_im = (dataset.<span class="keyword">to</span>(hv.Image, [<span class="string">'i'</span>, <span class="string">'j'</span>], <span class="attribute">dynamic</span>=<span class="literal">True</span>)</span><br><span class="line">                .options(<span class="attribute">cmap</span>=<span class="string">'Magma'</span>, <span class="attribute">width</span>=950, <span class="attribute">height</span>=600, <span class="attribute">colorbar</span>=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line">%output <span class="attribute">holomap</span>=<span class="string">'scrubber'</span> <span class="attribute">fps</span>=3</span><br><span class="line">regrid(hv_im, <span class="attribute">precompute</span>=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p><img src="../images/llc4320.png" alt></p>
<p>上图是南非南部海域的LLC4320 SST，可以看到强大的洋流和丰富的中小尺度涡旋。</p>
<p><img src="../images/llc2160.png" alt></p>
<p>上图作为对比是LLC2160的结果，和4320比较有一定差距。</p>
<h3 id="涡度计算示例"><a href="#涡度计算示例" class="headerlink" title="涡度计算示例"></a>涡度计算示例</h3><p>下面展示LLC4320涡度计算步骤。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">model = llcreader.ECCOPortalLLC4320Model()</span><br><span class="line"><span class="builtin-name">print</span>(model)</span><br><span class="line"></span><br><span class="line"><span class="comment"># volecity</span></span><br><span class="line">ds = model.get_dataset(varnames=[<span class="string">'U'</span>, <span class="string">'V'</span>], k_levels=[0], <span class="attribute">type</span>=<span class="string">'latlon'</span>,</span><br><span class="line">                        <span class="attribute">iter_start</span>=model.iter_start,</span><br><span class="line">                        iter_stop=(model.iter_start + model.iter_step),</span><br><span class="line">                        <span class="attribute">read_grid</span>=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Normal gridding</span></span><br><span class="line">import xgcm</span><br><span class="line">grid = xgcm.Grid(ds, periodic=[<span class="string">'X'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate vorticity</span></span><br><span class="line">zeta = (-grid.diff(ds.U * ds.dxC, <span class="string">'Y'</span>, <span class="attribute">boundary</span>=<span class="string">'fill'</span>) + grid.diff(ds.V * ds.dyC, <span class="string">'X'</span>))/ds.rAz</span><br><span class="line">zeta = zeta.squeeze().rename(<span class="string">'vorticity'</span>).reset_coords(<span class="attribute">drop</span>=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># load data</span></span><br><span class="line">zeta.load()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show</span></span><br><span class="line">dataset = hv.Dataset(zeta)</span><br><span class="line">hv_im = (dataset.<span class="keyword">to</span>(hv.Image, [<span class="string">'i_g'</span>, <span class="string">'j_g'</span>])</span><br><span class="line">                .options(<span class="attribute">cmap</span>=<span class="string">'RdBu_r'</span>, <span class="attribute">width</span>=950, <span class="attribute">height</span>=600, <span class="attribute">colorbar</span>=<span class="literal">True</span>, <span class="attribute">symmetric</span>=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line">regrid(hv_im, <span class="attribute">precompute</span>=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="../images/llc_v.png" alt></p>
<h3 id="扩展：云"><a href="#扩展：云" class="headerlink" title="扩展：云"></a>扩展：云</h3><p>虽然 ECCO 数据门户实现了数据自由访问，但它的带宽有限，国内用户往往正常加载。虽然它适合像交互式探索，但是如果想实际处理PB的数据，它可能无法提供必要的网络流量。</p>
<p>商业云存储（例如 Amazon S3 或 Google Cloud Storage）可以提供两全其美的优势。它既可公开访问，又具有极大的数据处理能力。</p>
<p>后面我将介绍云计算平台<code>Pangeo</code>，目前大量的地学大数据已经存储于云端，并可以通过<code>Pangeo</code>进行操作，这其中就包含LLC4320模式。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/08/02/llc1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/02/llc1/" class="post-title-link" itemprop="url">xmitgcm下载LLC海洋模式数据</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-02 11:50:14 / 修改时间：18:11:34" itemprop="dateCreated datePublished" datetime="2022-08-02T11:50:14+08:00">2022-08-02</time>
            </span>

          
            <span id="/2022/08/02/llc1/" class="post-meta-item leancloud_visitors" data-flag-title="xmitgcm下载LLC海洋模式数据" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/08/02/llc1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/08/02/llc1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>上一节，我们介绍了xmitgcm的LLCreader入门操作，总体上这个工具可以通过网络自动加载门户网站（ECCO）的模式数据，实现对大数据模式LLC4320和LLC2160的读取。但还有许多问题尚未解决：</p>
<ul>
<li>能否保存数据到本地</li>
<li>能否按照经纬范围选取数据</li>
<li>能否选择连续的一段时间（如70天，每小时一个）</li>
<li>能否做较复杂计算</li>
</ul>
<p>本节先介绍怎么通过LLCreader将数据下载本地，并使用GMT绘图。</p>
<h4 id="加载llcreader"><a href="#加载llcreader" class="headerlink" title="加载llcreader"></a>加载llcreader</h4><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xmitgcm.llcreader <span class="keyword">as</span> llcreader</span><br></pre></td></tr></table></figure>

<h4 id="初始化模型"><a href="#初始化模型" class="headerlink" title="初始化模型"></a>初始化模型</h4><p>因为LLC4320数据体量较大，这里先以LLC2160为例。我们选择<code>Theta</code>进行导出测试。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model = llcreader.ECCOPortalLLC2160Model()</span><br><span class="line"></span><br><span class="line">ds_sst = model.get_dataset(varnames=[<span class="string">'Theta'</span>], k_levels=[0], <span class="attribute">type</span>=<span class="string">'latlon'</span>,</span><br><span class="line">                          <span class="attribute">iter_start</span>=model.iter_start,</span><br><span class="line">                          iter_stop=(model.iter_start + model.iter_step),</span><br><span class="line">                          <span class="attribute">read_grid</span>=<span class="literal">True</span>)</span><br><span class="line">ds_sst.Theta</span><br></pre></td></tr></table></figure>
<p><img src="../images/llc1.png" alt></p>
<p><code>ds_sst</code>的数据结构为Xarray的<code>dataset</code>，<code>ds_sst.Theta</code>的数据结构为Xarray的<code>dataarray</code>。可以看到<code>Theta</code>的数据大小是231M，这只是一个小时快照的单层全球数据，体积不算太大。</p>
<p><img src="en-resource://database/1799:1" alt="424563f1e8a8cb5512488f4924a7206b.png"></p>
<p>上图为其<code>coordinates</code>，这是<code>dataarray</code>数据结构的一个关键术语，其中黑色粗体<code>i,j,k,time</code>表示维度坐标(Dimension coordinate)，其他为无维度坐标(Non-dimension coordinate)。</p>
<blockquote>
<p>Xarray: <a href="https://docs.xarray.dev/en/stable/user-guide/terminology.html#term-Dimension-coordinate" target="_blank" rel="noopener">https://docs.xarray.dev/en/stable/user-guide/terminology.html#term-Dimension-coordinate</a></p>
</blockquote>
<h4 id="绘图查看"><a href="#绘图查看" class="headerlink" title="绘图查看"></a>绘图查看</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">temp</span><span class="selector-class">.Theta</span><span class="selector-class">.plot</span>()</span><br></pre></td></tr></table></figure>
<p><img src="../images/llc2.png" alt></p>
<p>维度坐标<code>i,j</code>作为其<code>x</code>和<code>y</code>轴，另一维度<code>time</code>和<code>k</code>(深度0)出现在标题上。</p>
<p>因为LLC为特殊的网格结构，这里暂时不能直接实现地理绘图。后面会对此进行单独介绍。</p>
<h4 id="保存-to-netcdf"><a href="#保存-to-netcdf" class="headerlink" title="保存 .to_netcdf()"></a>保存 .to_netcdf()</h4><p><code>to_netcdf()</code>是<code>Xarray</code>内置的函数，可将数据保存为nc格式。注意数据保存和<code>llcreader</code>函数无关，<code>llcreader</code>的主要作用是在线获得LLC模式数据，并转化成<code>Xarray</code>特有的数据结构，后面所有的操作都是使用<code>Xarray</code>，因此有必要对<code>Xarray</code>做全面的学习。后面会对此介绍。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds_sst.<span class="module-access"><span class="module"><span class="identifier">Theta</span>.</span></span><span class="keyword">to</span><span class="constructor">_netcdf('<span class="params">myfile</span>.<span class="params">nc</span>')</span></span><br></pre></td></tr></table></figure>
<p>上述命令可以将<code>Theta</code>参数保存。通过<code>panoply</code>可以绘图展示SST参数的全球分布：</p>
<p><img src="../images/llc3.png" alt></p>
<h4 id="删除不重要的坐标"><a href="#删除不重要的坐标" class="headerlink" title="删除不重要的坐标"></a>删除不重要的坐标</h4><p>但可以发现保存的文件大小是2.5G，远远超过了其自身大小，这是什么原因呢？</p>
<p><img src="../images/llc5.png" alt></p>
<p>原来是把无维度坐标全部保存了，这些坐标其实也是数据，因此占用很大空间。一共有11个这样的2D坐标，再加上<code>Theta</code>，数据体积就达到2.5G了。<br><img src="../images/llc6.png" alt></p>
<p>这些无维度坐标可以删去：</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ds_sst.Theta.reset_coords<span class="params">()</span> <span class="comment"># 将无维度坐标转为变量(不删除)</span></span><br><span class="line">ds_sst[[<span class="string">"Theta"</span>]]<span class="string">.reset_coords</span><span class="params">(<span class="attr">drop</span>=True)</span> <span class="comment"># 将会删去无维度坐标</span></span><br></pre></td></tr></table></figure>
<p><img src="../images/llc7.png" alt></p>
<p>若想保留某些坐标，比如经纬度<code>XC,YC</code>：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ds_sst</span><span class="selector-class">.Theta</span><span class="selector-class">.reset_coords</span>()<span class="selector-attr">[[<span class="string">"XC"</span>, <span class="string">"YC"</span>,<span class="string">"Theta"</span>]</span>]</span><br></pre></td></tr></table></figure>
<p>上面使用了<code>[[ ]]</code>做变量的筛选。</p>
<blockquote>
<p>参考：<a href="https://docs.xarray.dev/en/stable/user-guide/data-structures.html#transforming-datasets" target="_blank" rel="noopener">https://docs.xarray.dev/en/stable/user-guide/data-structures.html#transforming-datasets</a></p>
</blockquote>
<p>然后保存：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ds_sst<span class="literal">[["T<span class="identifier">heta</span>"]</span>].reset<span class="constructor">_coords(<span class="params">drop</span>=True)</span>.<span class="keyword">to</span><span class="constructor">_netcdf('<span class="params">myfile2</span>.<span class="params">nc</span>')</span></span><br><span class="line">ds_sst.<span class="module-access"><span class="module"><span class="identifier">Theta</span>.</span></span>reset<span class="constructor">_coords()</span><span class="literal">[["XC", "YC","T<span class="identifier">heta</span>"]</span>].<span class="keyword">to</span><span class="constructor">_netcdf('<span class="params">myfile3</span>.<span class="params">nc</span>')</span></span><br></pre></td></tr></table></figure>
<p>这样，数据体积就小了，其中<code>myfile2.nc</code>仅包含<code>Theta</code>，大小213M。</p>
<p><img src="../images/llc8.png" alt></p>
<h4 id="GMT绘图"><a href="#GMT绘图" class="headerlink" title="GMT绘图"></a>GMT绘图</h4><p>GMT绘图比ython自带函数更加强大，既然已经下载到本地，则看一下GMT绘图效果：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gmt begin ex02 png</span><br><span class="line">	gmt set MAP_ANNOT_OBLIQUE <span class="number">0</span></span><br><span class="line">	gmt subplot begin <span class="number">2</span>x1 -A+JTL -Fs16c/<span class="number">10</span>c -M0 -R1000/<span class="number">2000</span>/<span class="number">2500</span>/<span class="number">3500</span> -JX15/<span class="number">13</span>c -B100 -T<span class="string">"Aghulhas Rings"</span></span><br><span class="line">		gmt subplot set <span class="number">0</span>,<span class="number">0</span> -Ce3c</span><br><span class="line">		gmt grd2cpt myfile3.nc?Theta -Cjet -Z</span><br><span class="line">		gmt grdimage myfile3.nc?Theta -I+a90  </span><br><span class="line">		gmt colorbar -DJRM+o1<span class="number">.5</span>c/<span class="number">0</span>+mc -I0<span class="number">.3</span> -Bx2+lTheta -By+ldegree</span><br><span class="line"></span><br><span class="line">		gmt subplot set <span class="number">1</span>,<span class="number">0</span> -Ce3c</span><br><span class="line">		gmt grd2cpt myfile4.nc?Theta -Crainbow -Z</span><br><span class="line">		gmt grdimage myfile4.nc?Theta</span><br><span class="line">		gmt colorbar -DJRM+o1<span class="number">.5</span>c/<span class="number">0</span>+e+mc -Bx2+lTheta -By+ldegree</span><br><span class="line">	gmt subplot end</span><br><span class="line">gmt end show</span><br></pre></td></tr></table></figure>

<p><img src="../images/4320.png" alt></p>
<h4 id="下节预告"><a href="#下节预告" class="headerlink" title="下节预告"></a>下节预告</h4><ul>
<li>范围的筛选</li>
<li>时间维度的连续导出</li>
</ul>
<h2 id="交流群"><a href="#交流群" class="headerlink" title="交流群"></a>交流群</h2><p>因为公众号留言功能未开通，为了促进交流，小编建立了一个QQ交流群，欢迎大家入群。暂时没开通微信群。</p>
<p><strong>主要功能定位：</strong></p>
<ul>
<li>交流国内外卫星遥感数据信息和现场实测数据信息</li>
<li>对国内海洋实测数据的申请提供必要的指导</li>
<li>物理海洋、大地测量、海洋遥感等学科交流</li>
<li>传播有价值的科研工具、开源程序，提高科研生产力</li>
</ul>
<p><img src="../images/qq.png" alt></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/07/13/gmt-authors/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/13/gmt-authors/" class="post-title-link" itemprop="url">GMT辅助文献计量学绘制作者产出和引用图</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-13 22:12:10 / 修改时间：22:55:38" itemprop="dateCreated datePublished" datetime="2022-07-13T22:12:10+08:00">2022-07-13</time>
            </span>

          
            <span id="/2022/07/13/gmt-authors/" class="post-meta-item leancloud_visitors" data-flag-title="GMT辅助文献计量学绘制作者产出和引用图" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/07/13/gmt-authors/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/07/13/gmt-authors/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在分析某一领域的核心贡献者时，往往使用年发文数量和年平均引用数量这两个指标，怎么将这两个指标在一个图形中展示呢？计量软件<code>bibliometrix</code>工具可以绘制这类图形，但是不容易被大众解读。今天推荐GMT的一个特别工具<code>wiggle</code>实现该目标。我们使用的例子还是卫星测高这个研究群体。</p>
<h2 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h2><p>从WoS下载卫星测高主题的元数据，1970年到2021年大约有8500多篇，作者有1,5000多位。</p>
<p>将数据导入<code>bibliometrix</code>软件。</p>
<blockquote>
<p>bibliometrix是一个R语言的文献计量软件包，统计分析的功能较为强大，绘图的灵活性较弱。这里我们仅使用其统计功能。更多参考：<a href="https://bibliometrix.org/" target="_blank" rel="noopener">https://bibliometrix.org/</a></p>
</blockquote>
<p>在作者一栏，我们选择：</p>
<p><img src="../images/AU1.png" alt></p>
<p>这里就可以看到图形了，但是不仔细看，分不清楚引用量是怎么表达的。</p>
<p><img src="../images/AU3.png" alt></p>
<p>仔细看的话，发现圆点的大小表示论文数量，圆点的颜色深浅表示引用数量，这种展示对于量化分析并不友好。</p>
<p>我们选择保存为csv文件，然后让GMT来绘图：</p>
<p><img src="../images/AU2.png" alt></p>
<h2 id="GMT代码"><a href="#GMT代码" class="headerlink" title="GMT代码"></a>GMT代码</h2><p>由于在一个csv文件中包含了所有信息，绘图需要使用循环的脚本，这里采用<code>pygmt</code>和<code>Python</code>相结合绘图。</p>
<p>主要代码如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(r<span class="string">".\author\Author_Production_Over_Time.csv"</span>)</span><br><span class="line"><span class="attribute">au</span>=df[<span class="string">'Author'</span>]</span><br><span class="line"></span><br><span class="line">fig = pygmt.Figure()</span><br><span class="line">fig.basemap(region=[1978, 2023, -20, 200], <span class="attribute">projection</span>=<span class="string">"X15c/15c"</span>, frame=[<span class="string">"Snlr"</span>, <span class="string">"xaf1"</span>])</span><br><span class="line"></span><br><span class="line">fruits = au.unique()</span><br><span class="line"><span class="attribute">fruits</span>=fruits[::-1] </span><br><span class="line"><span class="attribute">k</span>=-10</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(len(fruits)):</span><br><span class="line">    <span class="builtin-name">print</span> (<span class="string">'Present author : %s'</span> % fruits[index])</span><br><span class="line">    <span class="attribute">z</span>=df[<span class="string">'freq'</span>][df[<span class="string">'Author'</span>]== fruits[index]]</span><br><span class="line">    <span class="attribute">x</span>=df[<span class="string">'year'</span>][df[<span class="string">'Author'</span>]== fruits[index]]</span><br><span class="line">    <span class="attribute">y</span>=np.ones(x.values.size)+k</span><br><span class="line">    <span class="attribute">k</span>=k+10</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> k == 0:</span><br><span class="line">        fig.wiggle(</span><br><span class="line">            <span class="attribute">x</span>=x.values,</span><br><span class="line">            <span class="attribute">y</span>=y,</span><br><span class="line">            <span class="attribute">z</span>=z.values,</span><br><span class="line"></span><br><span class="line">            # <span class="builtin-name">Set</span> anomaly scale <span class="keyword">to</span> <span class="string">"20c"</span></span><br><span class="line">            <span class="attribute">scale</span>=<span class="string">"20"</span>,</span><br><span class="line">            # Fill positive <span class="keyword">and</span> negative areas red <span class="keyword">and</span> gray, respectively</span><br><span class="line">            color=[<span class="string">"red+p"</span>, <span class="string">"gray+n"</span>],</span><br><span class="line">            # <span class="builtin-name">Set</span> the outline width <span class="keyword">to</span> <span class="string">"1.0p"</span></span><br><span class="line">            <span class="attribute">pen</span>=<span class="string">"1.0p"</span>,</span><br><span class="line">            # Draw a blue track with a width of 0.5 points</span><br><span class="line">            <span class="attribute">track</span>=<span class="string">"0.5p,blue"</span>,</span><br><span class="line">            # Plot a vertical scale bar at the right middle. The bar length is 100 <span class="keyword">in</span></span><br><span class="line">            <span class="attribute">position</span>=<span class="string">"jLT+w10+lpublications+o0.2/0.2"</span>,</span><br><span class="line">            <span class="attribute">transparency</span>=50,</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        fig.wiggle(</span><br><span class="line">            <span class="attribute">x</span>=x.values,</span><br><span class="line">            <span class="attribute">y</span>=y,</span><br><span class="line">            <span class="attribute">z</span>=z.values,</span><br><span class="line"></span><br><span class="line">            # <span class="builtin-name">Set</span> anomaly scale <span class="keyword">to</span> <span class="string">"20c"</span></span><br><span class="line">            <span class="attribute">scale</span>=<span class="string">"20"</span>,</span><br><span class="line">            # Fill positive <span class="keyword">and</span> negative areas red <span class="keyword">and</span> gray, respectively</span><br><span class="line">            color=[<span class="string">"red+p"</span>, <span class="string">"gray+n"</span>],</span><br><span class="line">            # <span class="builtin-name">Set</span> the outline width <span class="keyword">to</span> <span class="string">"1.0p"</span></span><br><span class="line">            <span class="attribute">pen</span>=<span class="string">"1.0p"</span>,</span><br><span class="line">            # Draw a blue track with a width of 0.5 points</span><br><span class="line">            <span class="attribute">track</span>=<span class="string">"0.5p,blue"</span>,         </span><br><span class="line">            <span class="attribute">transparency</span>=50,</span><br><span class="line">        )</span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="attribute">k</span>=-10</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(len(fruits)):</span><br><span class="line">    <span class="builtin-name">print</span> (<span class="string">'Present author : %s'</span> % fruits[index])</span><br><span class="line">    <span class="attribute">z</span>=df[<span class="string">'TCpY'</span>][df[<span class="string">'Author'</span>]== fruits[index]]</span><br><span class="line">    <span class="attribute">x</span>=df[<span class="string">'year'</span>][df[<span class="string">'Author'</span>]== fruits[index]]</span><br><span class="line">    <span class="attribute">y</span>=np.ones(x.values.size)+k</span><br><span class="line">    <span class="attribute">k</span>=k+10</span><br><span class="line">    <span class="keyword">if</span> k == 0:</span><br><span class="line">        fig.wiggle(</span><br><span class="line">            <span class="attribute">x</span>=x.values,</span><br><span class="line">            <span class="attribute">y</span>=y,</span><br><span class="line">            <span class="attribute">z</span>=-z.values,</span><br><span class="line"></span><br><span class="line">            # <span class="builtin-name">Set</span> anomaly scale <span class="keyword">to</span> <span class="string">"20c"</span></span><br><span class="line">            <span class="attribute">scale</span>=<span class="string">"100"</span>,</span><br><span class="line">            # Fill positive <span class="keyword">and</span> negative areas red <span class="keyword">and</span> gray, respectively</span><br><span class="line">            color=[<span class="string">"red+p"</span>, <span class="string">"blue+n"</span>],</span><br><span class="line">            # <span class="builtin-name">Set</span> the outline width <span class="keyword">to</span> <span class="string">"1.0p"</span></span><br><span class="line">            <span class="attribute">pen</span>=<span class="string">"1.0p"</span>,</span><br><span class="line">            # Draw a blue track with a width of 0.5 points</span><br><span class="line">            <span class="attribute">track</span>=<span class="string">"0.5p,blue"</span>,</span><br><span class="line">            # Plot a vertical scale bar at the right middle. The bar length is 100 <span class="keyword">in</span>            </span><br><span class="line">            <span class="attribute">position</span>=<span class="string">"jLT+w50+lcitations/year+o0.2/0.9"</span>,</span><br><span class="line">            <span class="attribute">transparency</span>=50,</span><br><span class="line">        )    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        fig.wiggle(</span><br><span class="line">            <span class="attribute">x</span>=x.values,</span><br><span class="line">            <span class="attribute">y</span>=y,</span><br><span class="line">            <span class="attribute">z</span>=-z.values,</span><br><span class="line"></span><br><span class="line">            # <span class="builtin-name">Set</span> anomaly scale <span class="keyword">to</span> <span class="string">"20c"</span></span><br><span class="line">            <span class="attribute">scale</span>=<span class="string">"100"</span>,</span><br><span class="line">            # Fill positive <span class="keyword">and</span> negative areas red <span class="keyword">and</span> gray, respectively</span><br><span class="line">            color=[<span class="string">"red+p"</span>, <span class="string">"blue+n"</span>],</span><br><span class="line">            # <span class="builtin-name">Set</span> the outline width <span class="keyword">to</span> <span class="string">"1.0p"</span></span><br><span class="line">            <span class="attribute">pen</span>=<span class="string">"1.0p"</span>,</span><br><span class="line">            # Draw a blue track with a width of 0.5 points</span><br><span class="line">            <span class="attribute">track</span>=<span class="string">"0.5p,blue"</span>,</span><br><span class="line">            <span class="attribute">transparency</span>=50,</span><br><span class="line">        ) </span><br><span class="line"></span><br><span class="line"><span class="attribute">k</span>=-10</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(len(fruits)):</span><br><span class="line"></span><br><span class="line">    <span class="attribute">k</span>=k+10</span><br><span class="line"></span><br><span class="line">    fig.text(</span><br><span class="line">        region=[1978, 2030, -20, 200],</span><br><span class="line">        <span class="attribute">projection</span>=<span class="string">"X20c/15c"</span>,</span><br><span class="line">        <span class="attribute">x</span>=2017,</span><br><span class="line">        <span class="attribute">y</span>=1+k-10,</span><br><span class="line">        <span class="attribute">text</span>=fruits[index],</span><br><span class="line">        <span class="attribute">font</span>=<span class="string">"Courier-Bold"</span>,</span><br><span class="line">        <span class="attribute">justify</span>=<span class="string">"BL"</span>,</span><br><span class="line">        <span class="attribute">offset</span>=<span class="string">"0.75c/0c"</span>,</span><br><span class="line">    )        </span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>

<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p><img src="./images/AU4.png" alt></p>
<p>图上方红色区域表示作者的年度论文发表数量，下方的蓝色区域表示当年度发表论文的年均引用量。</p>
<p>可以看出卫星测高领域产出最大和引用最多的作者中有多位多位中国人，排名首位的是美国<code>The Ohio State University</code>的华人C.K. Shum。</p>
<blockquote>
<p>测试数据和代码：<a href="https://www.jianguoyun.com/p/DR0zR7YQ2PCQBxiK_MwEIAA" target="_blank" rel="noopener">https://www.jianguoyun.com/p/DR0zR7YQ2PCQBxiK_MwEIAA</a> </p>
</blockquote>
<p>文献计量分析的GMT案例到此结束。</p>
<h4 id="交流群"><a href="#交流群" class="headerlink" title="交流群"></a>交流群</h4><p>因为公众号留言功能未开通，为了促进交流，小编建立了一个QQ交流群，欢迎大家入群。暂时没开通微信群。</p>
<p><strong>主要功能定位：</strong></p>
<ul>
<li>交流国内外卫星遥感数据信息和现场实测数据信息</li>
<li>对国内海洋实测数据的申请提供必要的指导</li>
<li>物理海洋、大地测量、海洋遥感等学科交流</li>
<li>传播有价值的科研工具、开源程序，提高科研生产力</li>
</ul>
<p><img src="../images/qq.png" alt></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/07/09/3D-number/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/09/3D-number/" class="post-title-link" itemprop="url">GMT绘制3D柱状地理分布图</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-09 21:55:36 / 修改时间：22:43:52" itemprop="dateCreated datePublished" datetime="2022-07-09T21:55:36+08:00">2022-07-09</time>
            </span>

          
            <span id="/2022/07/09/3D-number/" class="post-meta-item leancloud_visitors" data-flag-title="GMT绘制3D柱状地理分布图" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/07/09/3D-number/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/07/09/3D-number/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>本期再次回到GMT绘图，介绍一种使用GMT绘制3D柱状图的方法，本例子数据采用的是卫星测高领域的研究国家和机构的文章数量。本图件可以直观的展示某一领域研究机构的空间地理分布和强度。对于综述文章或者研究生的文献调研有一定用途。</p>
</blockquote>
<h2 id="WoS数据"><a href="#WoS数据" class="headerlink" title="WoS数据"></a>WoS数据</h2><p>根据前几期文章介绍的方法，从Web of Science数据库检索相关主题，例如本次我们采用<code>satellite altimet*</code>，得到8000多篇研究结果。下载研究国家/地区和研究机构的文章数量数据。</p>
<p>机构数据：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Affiliations	Record Count	% of <span class="number">8</span>,<span class="number">505</span></span><br><span class="line">NATIONAL AERONAUTICS SPACE ADMINISTRATION	<span class="number">914</span>	<span class="number">10.747</span></span><br><span class="line">CENTRE NATIONAL DE LA RECHERCHE SCIENTIFIQUE 	<span class="number">828</span>	<span class="number">9.735</span></span><br><span class="line">INSTITUT DE RECHERCHE POUR LE DEVELOPPEMENT 	<span class="number">707</span>	<span class="number">8.313</span></span><br><span class="line">CHINESE ACADEMY OF SCIENCES	<span class="number">629</span>	<span class="number">7.396</span></span><br><span class="line">UNIVERSITE DE TOULOUSE	<span class="number">517</span>	<span class="number">6.079</span></span><br><span class="line">UNIVERSITE TOULOUSE III PAUL SABATIER	<span class="number">498</span>	<span class="number">5.855</span></span><br><span class="line">NASA GODDARD SPACE FLIGHT CENTER	<span class="number">483</span>	<span class="number">5.679</span></span><br><span class="line">LABORATOIRE D ETUDES EN GEOPHYSIQUE ET OCEANOGRAPHIE SPATIALES	<span class="number">439</span>	<span class="number">5.162</span></span><br><span class="line">NASA JET PROPULSION LABORATORY 	<span class="number">431</span>	<span class="number">5.068</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>国家数据：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USA	<span class="number">3118</span></span><br><span class="line">CHINA	<span class="number">1493</span></span><br><span class="line">FRANCE	<span class="number">1385</span></span><br><span class="line">ENGLAND	<span class="number">804</span></span><br><span class="line">GERMANY	<span class="number">748</span></span><br><span class="line">AUSTRALIA	<span class="number">421</span></span><br><span class="line">ITALY	<span class="number">421</span></span><br><span class="line">SPAIN	<span class="number">371</span></span><br><span class="line">NETHERLANDS	<span class="number">340</span></span><br><span class="line">CANADA	<span class="number">323</span></span><br></pre></td></tr></table></figure>

<h2 id="从地名到坐标"><a href="#从地名到坐标" class="headerlink" title="从地名到坐标"></a>从地名到坐标</h2><p>使用google sheet结合Geocode插件对研究机构和国家名称进行坐标解析。</p>
<blockquote>
<p>参考：<a href="https://workspace.google.com/marketplace/app/geocode_by_awesome_table/904124517349" target="_blank" rel="noopener">https://workspace.google.com/marketplace/app/geocode_by_awesome_table/904124517349</a></p>
</blockquote>
<p>得到：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Affiliations	long	lati</span><br><span class="line">NATIONAL AERONAUTICS SPACE ADMINISTRATION	<span class="number">-77.016389</span>	<span class="number">38.883056</span></span><br><span class="line">CENTRE NATIONAL DE LA RECHERCHE SCIENTIFIQUE 	<span class="number">2.2639934</span>	<span class="number">48.8476037</span></span><br><span class="line">INSTITUT DE RECHERCHE POUR LE DEVELOPPEMENT 	<span class="number">2.3</span>	<span class="number">48.9</span></span><br><span class="line">CHINESE ACADEMY OF SCIENCES	<span class="number">116.3356321</span>	<span class="number">39.9106327</span></span><br><span class="line">UNIVERSITE DE TOULOUSE	<span class="number">1.4</span>	<span class="number">43.6</span></span><br><span class="line">UNIVERSITE TOULOUSE III PAUL SABATIER	<span class="number">1.4699399</span>	<span class="number">43.5619586</span></span><br><span class="line">NASA GODDARD SPACE FLIGHT CENTER	<span class="number">-76.852344</span>	<span class="number">38.99495</span></span><br><span class="line">LABORATOIRE D ETUDES EN GEOPHYSIQUE ET OCEANOGRAPHIE SPATIALES	<span class="number">1.45</span>	<span class="number">43.65</span></span><br><span class="line">NASA JET PROPULSION LABORATORY 	<span class="number">-118.1713944</span>	<span class="number">34.2013081</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><p>数据整理完毕后，使用GMT绘制3D柱状图。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">REM For windows</span><br><span class="line"></span><br><span class="line">gmt gmtset FORMAT_GEO_MAP = dddF MAP_FRAME_WIDTH=<span class="number">2</span>p</span><br><span class="line">gmt gmtset FONT_ANNOT_PRIMARY <span class="number">7</span>p,Helvetica,black FONT_LABEL <span class="number">7</span>p,Helvetica,black </span><br><span class="line"></span><br><span class="line">set ps=<span class="number">3</span>d.ps</span><br><span class="line">gmt pscoast -JQ0/<span class="number">37.5</span>/<span class="number">10</span>c -R<span class="number">-180</span>/<span class="number">180</span>/<span class="number">-90</span>/<span class="number">90</span> -Dc -A10000/<span class="number">0</span>/<span class="number">1</span> -Sazure2 -Gwheat -Bxa60 -Bya30 --FONT_TITLE=<span class="number">10</span>p -K  --MAP_ANNOT_OBLIQUE=<span class="number">45</span> -p200/<span class="number">30</span> &gt; %ps%</span><br><span class="line">gawk <span class="string">"NF&gt;1 &#123;print $1, $2, $3&#125;"</span> loc | gmt psxyz  -R<span class="number">-180</span>/<span class="number">180</span>/<span class="number">-90</span>/<span class="number">90</span>/<span class="number">0</span>/<span class="number">1000</span> -J -JZ1<span class="number">.5</span>i -So0<span class="number">.1</span>c -Gred -O -K -p -Bza200+l<span class="string">"Publication numbers by affiliation"</span> -BWSneZ -t20 &gt;&gt;%ps%</span><br><span class="line"></span><br><span class="line">gmt pscoast -JQ0/<span class="number">37.5</span>/<span class="number">10</span>c -R<span class="number">-180</span>/<span class="number">180</span>/<span class="number">-90</span>/<span class="number">90</span> -Dc -A10000/<span class="number">0</span>/<span class="number">1</span> -Sazure2 -Gwheat -Bxa60 -Bya30 --FONT_TITLE=<span class="number">10</span>p -K -O --MAP_ANNOT_OBLIQUE=<span class="number">45</span> -p200/<span class="number">30</span> -Y6c &gt;&gt; %ps%</span><br><span class="line">gawk <span class="string">"&#123;print $2, $3, $4&#125;"</span> loc_c | gmt psxyz -R<span class="number">-180</span>/<span class="number">180</span>/<span class="number">-90</span>/<span class="number">90</span>/<span class="number">0</span>/<span class="number">3200</span> -J -JZ1<span class="number">.5</span>i -So0<span class="number">.2</span>c -Gblue -Bza500+l<span class="string">"Publication numbers by country/region"</span> -BWSneZ -O  -p -hi1 &gt;&gt;%ps%</span><br><span class="line">gmt psconvert %ps%  -A -P -Tf</span><br></pre></td></tr></table></figure>

<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p><img src="../images/3d_geo.png" alt></p>
<p>图中上部分为国家和地区的发表卫星测高相关的文章数量，下部分为机构发表的文章数量。首先，国家和地区较为集中在美国、法国、中国、英国和德国，以中国为例，相关研究机构主要分布在东部地区，最高为位于北京的中科院大学。</p>
<h2 id="附赠平面图绘制代码"><a href="#附赠平面图绘制代码" class="headerlink" title="附赠平面图绘制代码"></a>附赠平面图绘制代码</h2><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM For windows</span></span><br><span class="line"></span><br><span class="line">gmt gmtset FORMAT_GEO_MAP = dddF MAP_FRAME_WIDTH=<span class="number">2</span>p</span><br><span class="line">gmt gmtset FONT_ANNOT_PRIMARY <span class="number">7</span>p,Helvetica,black FONT_LABEL <span class="number">7</span>p,Helvetica,black </span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> ps=fig1.ps</span><br><span class="line">gmt pscoast -JN4.<span class="number">5</span>i -<span class="built_in">Rd</span> -Dc -A10000/<span class="number">0</span>/<span class="number">1</span> -Ba --FONT_TITLE=<span class="number">10</span>p -K  -W0.<span class="number">1</span>p --MAP_ANNOT_OBLIQUE=<span class="number">45</span>  &gt; <span class="variable">%ps%</span></span><br><span class="line">gawk "&#123;<span class="built_in">print</span> $<span class="number">1</span>, $<span class="number">2</span>, log($<span class="number">3</span>)/log(<span class="number">10</span>)/<span class="number">10</span>&#125;" loc | gmt psxy -R -J  -Sc -Gred -K -O -t55 &gt;&gt;<span class="variable">%ps%</span></span><br><span class="line">gawk "&#123;<span class="built_in">print</span> $<span class="number">2</span>, $<span class="number">3</span>, $<span class="number">4</span>/<span class="number">2000</span>&#125;" loc_c | gmt psxy -R -J  -Sc -Gblue -O -t75 &gt;&gt;<span class="variable">%ps%</span></span><br><span class="line"></span><br><span class="line">gmt psconvert <span class="variable">%ps%</span>  -A -P -Tg</span><br></pre></td></tr></table></figure>
<p>注意国家发文数量使用了对数化处理。图件缺少比例尺，有兴趣的同学可以修改代码加上。</p>
<p><img src="../images/2d_geo.png" alt></p>
<p>至于哪一种表达方式效果更佳，小编也难以下结论，这或许和数据特点和个人喜好有关。</p>
<h2 id="样本数据下载"><a href="#样本数据下载" class="headerlink" title="样本数据下载"></a>样本数据下载</h2><blockquote>
<p><a href="https://www.jianguoyun.com/p/DSoojxEQ2PCQBxjioswEIAA" target="_blank" rel="noopener">https://www.jianguoyun.com/p/DSoojxEQ2PCQBxjioswEIAA</a> </p>
</blockquote>
<h2 id="号外"><a href="#号外" class="headerlink" title="号外"></a>号外</h2><p>因为公众号留言功能未开通，为了促进交流，小编建立了一个QQ交流群，欢迎大家入群。暂时没开通微信群。</p>
<p><strong>主要功能定位：</strong></p>
<ul>
<li>交流国内外卫星遥感数据信息和现场实测数据信息</li>
<li>对国内海洋实测数据的申请提供必要的指导</li>
<li>物理海洋、大地测量、海洋遥感等学科交流</li>
<li>传播有价值的科研工具、开源程序，提高科研生产力</li>
</ul>
<p><img src="../images/qq.png" alt></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/07/03/gantt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/03/gantt/" class="post-title-link" itemprop="url">绘制卫星的gantt图</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-03 11:22:03 / 修改时间：12:06:18" itemprop="dateCreated datePublished" datetime="2022-07-03T11:22:03+08:00">2022-07-03</time>
            </span>

          
            <span id="/2022/07/03/gantt/" class="post-meta-item leancloud_visitors" data-flag-title="绘制卫星的gantt图" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/07/03/gantt/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/07/03/gantt/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>以卫星高度计任务为例，绘制Gantt图，以展示过去、现在和未来的卫星任务时间轴。此类图形对于综述文章或者研究生开题报告有一定帮助。</p>
<blockquote>
<p>甘特图（Gantt Chart）简介：它是条状图的一种流行类型，显示项目进度以及其他与时间相关的系统进展的内在关系随着时间进展的情况，是由亨利·甘特 (Henry Laurence Gantt) 于1910年开发出。在项目管理中，甘特图显示项目的终端元素的开始和结束，概要元素或终端元素的依赖关系。</p>
</blockquote>
<p><img src="./images/ga1.png" alt></p>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p>我们采用Python库<code>plotly</code>的<code>plotly.express</code>模块来绘制Gantt图。其优点是高度集成，节省代码，方便学习使用。</p>
<blockquote>
<p><code>plotly.express</code>可以绘制许多类型的图形，包含那些常见的不常见的、常用的不常用，如散点图、线条图、PIE图、Bar图、泡泡图、桑吉图、Sunburst图、Icicle图等等。详见：<a href="https://plotly.com/python/plotly-express/" target="_blank" rel="noopener">https://plotly.com/python/plotly-express/</a></p>
</blockquote>
<h2 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h2><p>输入的数据格式采用pandas的<code>DataFrame</code>，内容包含任务名称、开始时间和结束时间。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([</span><br><span class="line">    dict(<span class="attribute">Task</span>=<span class="string">"Job A"</span>, <span class="attribute">Start</span>=<span class="string">'2009-01-01'</span>, <span class="attribute">Finish</span>=<span class="string">'2009-02-28'</span>),</span><br><span class="line">    dict(<span class="attribute">Task</span>=<span class="string">"Job B"</span>, <span class="attribute">Start</span>=<span class="string">'2009-03-05'</span>, <span class="attribute">Finish</span>=<span class="string">'2009-04-15'</span>),</span><br><span class="line">    dict(<span class="attribute">Task</span>=<span class="string">"Job C"</span>, <span class="attribute">Start</span>=<span class="string">'2009-02-20'</span>, <span class="attribute">Finish</span>=<span class="string">'2009-05-30'</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>对于卫星任务，我们可以设置如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([dict(<span class="attribute">Satellite</span>=<span class="string">"TP"</span>, <span class="attribute">Start</span>=<span class="string">'1992-8-11'</span>, <span class="attribute">Finish</span>=<span class="string">'2005-12-31'</span>,Country="USA-FR")])</span><br></pre></td></tr></table></figure>

<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>Python全部绘图代码如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Install Plotly</span></span><br><span class="line"><span class="comment"># pip install plotly</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Import required libraries</span></span><br><span class="line">import plotly.express as px</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line"><span class="comment">#Create input data aggregated for each Satellite for each Country type</span></span><br><span class="line">df = pd.DataFrame([</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"GEOSAT"</span>, <span class="attribute">Start</span>=<span class="string">'1985-3-1'</span>, <span class="attribute">Finish</span>=<span class="string">'1989-12-1'</span>,Country="USA"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"ERS-1"</span>, <span class="attribute">Start</span>=<span class="string">'1991-7-1'</span>, <span class="attribute">Finish</span>=<span class="string">'1995-6-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"TP"</span>, <span class="attribute">Start</span>=<span class="string">'1992-8-11'</span>, <span class="attribute">Finish</span>=<span class="string">'2005-12-31'</span>,Country="USA-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"ERS-2"</span>, <span class="attribute">Start</span>=<span class="string">'1995-4-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2002-6-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"GFO"</span>, <span class="attribute">Start</span>=<span class="string">'1998-5-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2008-9-1'</span>,Country="USA"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Jason-2"</span>, <span class="attribute">Start</span>=<span class="string">'2001-11-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2013-7-1'</span>,Country="USA-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"ENVISAT"</span>, <span class="attribute">Start</span>=<span class="string">'2002-3-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2012-4-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Icesat-1"</span>, <span class="attribute">Start</span>=<span class="string">'2003-1-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2010-2-1'</span>,Country="USA"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Jason-2"</span>, <span class="attribute">Start</span>=<span class="string">'2008-6-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2019-10-1'</span>,Country="USA-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Cryosat-2"</span>, <span class="attribute">Start</span>=<span class="string">'2010-4-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2024-4-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2A"</span>, <span class="attribute">Start</span>=<span class="string">'2011-8-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2020-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Saral"</span>, <span class="attribute">Start</span>=<span class="string">'2013-2-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2022-12-31'</span>,Country="IN-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Sentinel-3A"</span>, <span class="attribute">Start</span>=<span class="string">'2016-2-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2023-4-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Jason-3"</span>, <span class="attribute">Start</span>=<span class="string">'2016-1-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2022-4-1'</span>,Country="USA-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Sentinel-3B"</span>, <span class="attribute">Start</span>=<span class="string">'2018-4-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2025-4-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Sentinel-3C"</span>, <span class="attribute">Start</span>=<span class="string">'2024-4-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2031-4-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Sentinel-3D"</span>, <span class="attribute">Start</span>=<span class="string">'2028-4-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2035-4-1'</span>,Country="EU"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Icesat-2"</span>, <span class="attribute">Start</span>=<span class="string">'2018-9-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2023-1-1'</span>,Country="USA"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2B"</span>, <span class="attribute">Start</span>=<span class="string">'2018-10-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2023-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2C"</span>, <span class="attribute">Start</span>=<span class="string">'2020-9-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2025-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Sentinel-6 Michael Freilich"</span>, <span class="attribute">Start</span>=<span class="string">'2020-11-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2027-1-1'</span>,Country="USA-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2D"</span>, <span class="attribute">Start</span>=<span class="string">'2021-5-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2026-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2E"</span>, <span class="attribute">Start</span>=<span class="string">'2022-5-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2027-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2F"</span>, <span class="attribute">Start</span>=<span class="string">'2023-5-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2028-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2G"</span>, <span class="attribute">Start</span>=<span class="string">'2024-5-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2029-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"HY-2H"</span>, <span class="attribute">Start</span>=<span class="string">'2025-5-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2030-4-1'</span>,Country="CN"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"SWOT"</span>, <span class="attribute">Start</span>=<span class="string">'2022-5-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2026-4-1'</span>,Country="USA-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"Sentinel-6B"</span>, <span class="attribute">Start</span>=<span class="string">'2025-1-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2032-1-1'</span>,Country="USA-FR"),</span><br><span class="line">    dict(<span class="attribute">Satellite</span>=<span class="string">"COMPIRA"</span>, <span class="attribute">Start</span>=<span class="string">'2022-10-1'</span>, <span class="attribute">Finish</span>=<span class="string">'2026-1-1'</span>,Country="JP"),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">#generate visualization</span></span><br><span class="line">fig = px.timeline(df, <span class="attribute">x_start</span>=<span class="string">"Start"</span>, <span class="attribute">x_end</span>=<span class="string">"Finish"</span>, <span class="attribute">y</span>=<span class="string">"Satellite"</span>, color = <span class="string">"Country"</span>,text =<span class="string">"Satellite"</span>,<span class="attribute">width</span>=1000,height=800)</span><br><span class="line">fig.update_yaxes(<span class="attribute">autorange</span>=<span class="string">"reversed"</span>)</span><br><span class="line">fig.update_layout(<span class="attribute">showlegend</span>=<span class="literal">True</span>,legend_x=0.89,legend_y=0.99)</span><br><span class="line">fig.update_yaxes(<span class="attribute">title_text</span>=<span class="string">"Satellite"</span>)</span><br><span class="line">fig.update_xaxes(<span class="attribute">title_text</span>=<span class="string">"Time"</span>)</span><br><span class="line"></span><br><span class="line">fig.add_vline(<span class="attribute">x</span>=<span class="string">'2022-7-1'</span>,line_color="black",line_dash="dot",opacity=0.5)</span><br><span class="line"></span><br><span class="line">fig.add_vrect(<span class="attribute">x0</span>=<span class="string">'2022-7-1'</span>, <span class="attribute">x1</span>=<span class="string">'2038-1-1'</span>,line_color="green",fillcolor="red", <span class="attribute">opacity</span>=0.2,</span><br><span class="line">                           <span class="attribute">annotation_text</span>=<span class="string">""</span>, <span class="attribute">annotation_position</span>=<span class="string">"bottom left"</span>,</span><br><span class="line">              <span class="attribute">annotation</span>=dict(font_size=20, <span class="attribute">font_family</span>=<span class="string">"Times New Roman"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig.update_xaxes(<span class="attribute">showgrid</span>=<span class="literal">True</span>, <span class="attribute">gridwidth</span>=1, <span class="attribute">gridcolor</span>=<span class="string">'LightPink'</span>)</span><br><span class="line">fig.update_yaxes(<span class="attribute">nticks</span>=30)</span><br><span class="line">fig.update_yaxes(<span class="attribute">showgrid</span>=<span class="literal">False</span>,showticklabels=False)</span><br><span class="line">fig.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save fig</span></span><br><span class="line">fig.write_image(<span class="string">"fig_sat.pdf"</span>)</span><br><span class="line">fig.write_image(<span class="string">"fig_sat.png"</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Jupyter Notebook版本的代码见：<a href="https://github.com/yangleir/RemoteSensing_paper/blob/main/fig1_gantt/gantt.ipynb" target="_blank" rel="noopener">https://github.com/yangleir/RemoteSensing_paper/blob/main/fig1_gantt/gantt.ipynb</a></p>
</blockquote>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>通过上面的代码，我们绘制了Gantt图，通过卫星任务的国家和地区进行分组。此外，还添加了当前时间线，以及对未来时间区间做透明填充。</p>
<p><img src="./images/ga2.png" alt></p>
<h2 id="调整"><a href="#调整" class="headerlink" title="调整"></a>调整</h2><p>这里暂不探讨一些绘图的细节，有兴趣的同学可以尝试修改下方的部分代码，<code>False</code>改为<code>True</code>。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fig.update<span class="constructor">_yaxes(<span class="params">nticks</span>=30)</span></span><br><span class="line">fig.update<span class="constructor">_yaxes(<span class="params">showgrid</span>=False,<span class="params">showticklabels</span>=False)</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/07/03/zotero-tags/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/03/zotero-tags/" class="post-title-link" itemprop="url">Zotero 为文献打标</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-03 10:50:20 / 修改时间：10:53:14" itemprop="dateCreated datePublished" datetime="2022-07-03T10:50:20+08:00">2022-07-03</time>
            </span>

          
            <span id="/2022/07/03/zotero-tags/" class="post-meta-item leancloud_visitors" data-flag-title="Zotero 为文献打标" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/07/03/zotero-tags/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/07/03/zotero-tags/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Zotero-为文献打标"><a href="#Zotero-为文献打标" class="headerlink" title="Zotero 为文献打标"></a>Zotero 为文献打标</h1><p>今天为大家分享一个Zotero使用小窍门，为文献打上可爱的表情。</p>
<h2 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h2><p>希望对一些文献进行标星分类，表示其具有高价值。这样在日后的文献阅读中，可以在自己庞大的文献库中快速找到这些文献。</p>
<p>除了标星之外，我们还可以使用有意思的图标对文献进行贴标签，形成相关的文献集，方便日后查阅回顾。</p>
<h2 id="Emoji表情符号"><a href="#Emoji表情符号" class="headerlink" title="Emoji表情符号"></a>Emoji表情符号</h2><p>我们使用Emoji为文献打标签。</p>
<p>前往Emoji站点搜索自己想要的表情符号，比如最常用的<code>喜欢
❤️</code>标签，可以通过下面的网站搜索<code>Red heart</code>，就能够找到许多类似表情，然后复制它。</p>
<blockquote>
<p>推荐Emoji网站： <a href="https://emojipedia.org/" target="_blank" rel="noopener">https://emojipedia.org/</a></p>
</blockquote>
<h2 id="Zotero"><a href="#Zotero" class="headerlink" title="Zotero"></a>Zotero</h2><p>回到Zotero，选择喜欢的论文，点击右上侧的<code>Tags</code>选项，<code>add</code>一下，把复制的❤️标签粘贴。❤️的数量可以随意设置，五星就粘贴五次。</p>
<p>这样完成了第一步打标签，在Zotero的左下角出现❤️标签，单击它，可以进行文献筛选。但是我们在文献的前方还是看不到标签，不利于我们快速定位文献。</p>
<p>接下来，右击❤️标签，选择<code>Assign color</code>，然后弹出对话框，选择数字和颜色，确定即可。</p>
<p><img src="./images/zo1.png" alt></p>
<p>之后，在文献的前面就出现一个❤️的表情。</p>
<p><img src="./images/zo2.png" alt></p>
<p>取消标记，只需要按键盘数字1。</p>
<p>之后，我们可以根据文献设置不同的标签。同一文献可以设置多个标签。</p>
<p><img src="./images/zo3.png" alt></p>
<p>如果想在一个文献集合中仅显示❤️文献，点击右下角的❤️即可完成筛选。</p>
<p>这种打标的做法还是很方便的，特别是对于阅读大量文献的硕博士来说，常常忘记自己最欣赏的文章在哪里藏着是一个头疼事。</p>
<p>尽管我们可以通过新建不同的<code>subcollection</code>来实现初步分类，但当每一个<code>subcollection</code>中的文献数据增加后，通过标签还是可以快速找到最爱。</p>
<center><font face="黑体" size="3" color="gold">好了，今天的分享就到这了，希望有用。谢谢大家。</font></center>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/06/19/sv/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/19/sv/" class="post-title-link" itemprop="url">世界知名海洋学家HARALD ULRIK SVERDRUP</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-06-19 13:48:06 / 修改时间：23:03:32" itemprop="dateCreated datePublished" datetime="2022-06-19T13:48:06+08:00">2022-06-19</time>
            </span>

          
            <span id="/2022/06/19/sv/" class="post-meta-item leancloud_visitors" data-flag-title="世界知名海洋学家HARALD ULRIK SVERDRUP" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/06/19/sv/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/06/19/sv/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="HARALD-ULRIK-SVERDRUP"><a href="#HARALD-ULRIK-SVERDRUP" class="headerlink" title="HARALD ULRIK SVERDRUP"></a>HARALD ULRIK SVERDRUP</h1><p><img src="./images/sv1.jpg" alt></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote>
<p>海洋学家和气象学家,曾任SIO所长和挪威极地研究所所长 。 </p>
</blockquote>
<ul>
<li>Harald Ulrik Sverdrup于1888年11月出生于挪威大户Sverdrup家族。</li>
<li>1911年，他在奥斯陆大学开始地球物理学生涯，然后从1913年到1917年在莱比锡大学攻读PhD学位。</li>
<li>1926年被任命为卑尔根气象学主席，并于1931年被任命为Christian Michelsen Institute教授。</li>
<li>1930年在华盛顿卡内基研究所工作，开始分析太平洋水文信息。</li>
<li>1931年在Nautilus号潜艇上进行北极探险队。</li>
<li>1936年被任命为SIO所长，并在那里工作了12年。在Sverdrup的领导下，SIO转变为现代海洋学机构，在此期间与Walter Munk合作，对二战登陆进行海浪预报。</li>
<li>1947年，发表重要论文“斜压海洋中的风驱动洋流”。</li>
<li>1948年，回到挪威，主持挪威极地研究所工作。 </li>
<li>1957年8月突然去世。</li>
</ul>
<p>Sverdrup的是美国科学院和挪威科学院的成员，瑞典北极星勋章、美国国家科学院的阿加西奖章、皇家地理学会奖章和布鲁斯奖章获得者。曾担任国际物理海洋学协会和国际海洋勘探理事会主席、美国地球物理联盟副主席（兼海洋学部主席）。</p>
<blockquote>
<p><strong>家族成员</strong>：爸爸Edvard Sverdrup是挪威神学家，爷爷Harald Ulrik Sverdrup是牧师和挪威议会议员，叔公（爸爸的叔叔）Johan Sverdrup创立自由党，并曾任挪威首相，叔叔Jakob Sverdrup是挪威议会议员，叔叔Georg Sverdrup创立路德教会自由教会，任神学院院长。 妹妹Mimi Sverdrup Lunden是作家和女权活动家，兄弟Leif Sverdrup是美国陆军将军，兄弟Einar Sverdrup是挪威矿老板，死于抵抗德军入侵的保卫战。Harald Sverdrup未生育子女。</p>
</blockquote>
<h2 id="成就"><a href="#成就" class="headerlink" title="成就"></a>成就</h2><ul>
<li>提出Sverdrup平衡，和Stommel、Munk前后独立发表了SSM论文。<code>Sverdrup (1947), Stommel (1948),and Munk (1950)</code>。</li>
<li>领导SIO成为现代化的双一流海洋科学机构。</li>
<li>解释赤道逆流。</li>
<li>为诺曼底登陆预报海浪。</li>
<li>海水流量以其名字缩写Sv命名。</li>
</ul>
<h2 id="传记"><a href="#传记" class="headerlink" title="传记"></a>传记</h2><p>根据Sverdrup在1948年返回挪威后为美国国家科学院撰写的自传（未出版），SIO后任所长William整理并发表这份Sverdrup传记。下面通过这篇文章回顾其一生。</p>
<blockquote>
<p>[1]A. NIERENBERG W. Harald Ulrik Sverdrup[M]. National Academies Press, 1996.</p>
</blockquote>
<h3 id="挪威和德国期间"><a href="#挪威和德国期间" class="headerlink" title="挪威和德国期间"></a>挪威和德国期间</h3><p>在挪威，Harald Sverdrup不仅被公认为伟大的科学家，而且还是北极探险家和古老而尊贵的大户人家一员。</p>
<p><img src="./images/sv2.png" alt></p>
<p>Harald Sverdrup于1888年11月15日出生在挪威松恩的松达尔，他的父亲Johan Edvard Sverdrup (1866-1923)在那里的成人学校任教。Harald Sverdrup的爸爸和他的四个叔叔一样，是挪威国教（路德教会）的牧师，1908年，他爸爸成为奥斯陆的教会历史教授。</p>
<p>Sverdrup家族的首个史料记录出现在1620年，但在清晰的家谱中，Sverdrup只能追溯到他的曾曾爷爷（一位挪威北部的大地主）。 1813年，这位曾曾爷爷的三个儿子之一的Georg Sverdrup成为奥斯陆大学最早的古典哲学和语言教授，他还参加了挪威制宪会议，并且是最终文件的三位作者之一。三儿子中最小的一个，也就是海洋学家Harald Sverdrup的曾爷爷Jacob Liv Borch Sverdrup (1775-1841) 成为土地管理专家，并在挪威建立了第一所农业学校，他的两个儿子声名显赫，Johan Sverdrup (1816-1892)是议会成员，并成为自由党的领袖，并成功引入了议会制度。Harald Sverdrup的爷爷Harald Ulrik Sverdrup (1813-91)排行老大，也是一名牧师，还长期在议会任职，并经营了许多生意，从水果种植到银行，再到航运。</p>
<p>他的妈妈Maria Vollan在他还是个孩子的时候就去世了。由于爸爸多变的职业生涯，Harald少年时代的大部分时间都在挪威西部的各个地方度过，并由家庭教师教授文化课，直到他 14岁才在开始进入校园上学。在Harald的青春期，他经历了对自然科学的兴趣和家族神学专业之间的冲突。根据他自己的说法，他是丹麦先进出版物<strong>Frem</strong>的热心读者，这份杂志涵盖了整个科学领域，他很难将进化论与他的宗教信仰相协调。</p>
<p>以优异的成绩离开中学后，他在奥斯陆度过了一年的时间，并通过大学初试。他参加了Norwegian Academy of War的义务兵，并学习了物理和数学。他在回忆录中特别指出，他参加义务兵的一年并没有因为需要体能训练而浪费时间，体能训练对他漫长的北极考察中的生存和表现至关重要。</p>
<p>1908年进入大学时，Sverdrup的专业是天文学。1911年，他获得了挪威杰出气象学家和卑尔根学院创始人Vilhelm<br>Bjerknes教授的助教职位，并确定了他的研究兴趣。 他们的关系不是通常的导师与学生的关系。 Bjerknes的助手是他们这一代最聪明的年轻科学家，他们包括Jacob Bjerknes（Vilhelm<br>Bjerknes的儿子，出生于瑞典的美国籍气象学家）、Tor Bergeron（瑞典气象学家）、Olaf Devik（挪威物理学家）、Theodore Hesselberg（挪威气象学家，曾担任气象研究所所长40年）、Carl-Gustaf Rossby（对，就是那位Rossby）和Halvor Solberg（挪威科学与文学院院士）。</p>
<p>Sverdrup指出美国<strong>卡内基研究所</strong>的长期资助在早期在发展地球科学方面发挥的重要作用，Sverdrup本人在整个职业生涯中都得到了该机构的支持。</p>
<p>Sverdrup最初希望继续研究天文学，但他对<strong>气象学和海洋学</strong>越来越感兴趣，于是转了专业。1912年，Bjerknes前往莱比锡大学担任教授和新地球物理研究所所长，1913至1917年，Sverdrup陪同他在德国工作，并在那里完成了奥斯陆大学的PhD论文，于1917年6月获得了博士学位。</p>
<h3 id="一个持续7年的北极航次"><a href="#一个持续7年的北极航次" class="headerlink" title="一个持续7年的北极航次"></a>一个持续7年的北极航次</h3><p>Sverdrup 似乎无法避免北极科考的命运。</p>
<p>1913年，Roald Amundsen重新开始了他的北极探险计划，Sverdrup拒绝了首席科学家助理的邀请，因为他希望完成他的大学工作。</p>
<p>1917年，他被提升为首席科学家，于是他接受了。Sverdrup在北极的经历塑造了他作为一个男人和一个科学家的双重性格。他在晚年向他的学生们讲述了北极的艰辛故事，并评论说：“那些年真的很有价值，因为它们让我与大自然进行了最密切的接触。”</p>
<p><img src="./images/sv4.jpg" alt></p>
<p>探险队于1918年 7 月 18 日离开挪威，预计航次时间为三到四年，但却持续了七年半，其中包括1921-22年在美国的十个月的中断，这期间他第一次访问了华盛顿卡内基研究所，这也是他第一次到美国旅行。</p>
<p>Sverdrup直到1925 年 12 月 22 日才返回挪威。</p>
<p>Sverdrup 认为北极科考调查可更好的理解洋流的基本物理特性，因为在极地可以得到最好的和最简单的海洋动力学观察（那里是地球自转最大的）。他讲述了Nansen如何凭经验认识到<strong>矢量旋转</strong>作为深度函数的可能性，并向Bjerknes建议应该更正式地研究它。Bjerknes将这个问题分配给了一位年轻的数学物理学家 <strong>V. Walfrid Ekman</strong>，他解决了这个问题，被称为Ekman Spiral现象。它直接类比于电磁学中的Coq效应（skin effect）。</p>
<p>Sverdrup于1926年被任命为卑尔根气象学的主席（Bjerknes空出），在这个岗位上，他研究了在七年北极探险的数据，并编辑了航次报告，他个人贡献了约三分之二。然而，在担任这个职位之前，他在华盛顿的卡内基研究所花了十个月研究同一航次的电磁数据，他在这期间两次拒绝了长期职位。他还访问了几个美国实验室，包括对SIO的短暂访问。有趣的是，如果Sverdrup接受了卡内基的长期职位，他几乎肯定会成为1930年成立的伍兹霍尔海洋研究所的第一任所长。那样的话，美国海洋学的机构历史将会大不相同。</p>
<h3 id="结婚"><a href="#结婚" class="headerlink" title="结婚"></a>结婚</h3><p>回到挪威后不久，Sverdrup与古德伦·布隆·沃蒙德结婚。他们没有孩子，但他收养了古德伦第一次婚姻的女儿。</p>
<h3 id="SIO"><a href="#SIO" class="headerlink" title="SIO"></a>SIO</h3><p>直到1935年12月，Sverdrup的生活发生了巨大的变化。他的领导从美国回来，告诉Sverdrup，他可能会替代Thomas Wayland Vaughan（1924年，成为SIO所长，1936年退休）成为新的SIO所长。Sverdrup同意了，他接受了很快发出的邀请。Sverdrup从1936年担任SIO的负责人近12年。</p>
<p>1936年选择Sverdrup担任SIO所长，这是加州大学做出的最明智的决定之一。除了长期担任加州大学校长的Sproul之外，没有人能够预见到巨大的后果。Sproul与Sverdrup稳步合作，以改善该机构（SIO曾被前大学校长忽视）。Sproul是一位伟大的大学校长，当他发现杰出的人才时，他全力以赴地支持，并创造了一个让个人留下来工作的环境。</p>
<p>1936年，SIO是一个偏远且尘土飞扬的小型海洋站，有一艘只能进行沿海航行的研究船和大约30名工作人员，其中包括8名教职员工。它的年度运营预算约为 89,000 美元，主要来自斯克里普斯家族的捐款。</p>
<p>Sverdrup 1936到达拉霍亚时，一定对这里简陋的设施感到惊讶，据说他的爱人在她第一次看到一家人将长期居住的小房子时哭了。Sverdrup 带着几个近期目标开始工作，他首先需要一艘新的远洋调查船，<strong>他还想增加该机构的收入</strong>，提高员工士气，并在研究人员之间建立更紧密的联系。他的长期目标是制定SIO研究计划并改善该机构的教学。</p>
<p>Sverdrup于1937年从当时在拉霍亚家族Robert Paine Scripps那里得到了他需要的船只。Scripps先生对Sverdrup印象深刻，并同意不仅为该机构提供一艘远洋船 R/V EW Scripps，而且还同意增加该机构的家庭捐款。Sverdrup对Scripps家族长期支持的希望因Scripps先生第二年的英年早逝而破灭。</p>
<p>Sverdrup在SIO和加州大学洛杉矶分校之间建立了密切的工作联系，该校于1936年为SIO学生授予学位。他活跃于学术评议会，在加州大学洛杉矶分校教授课程，并与加州大学洛杉矶分校的管理人员和教师建立了友谊。Vilhelm Bjerknes 的另外两个助手 Jacob Bjerknes 和 Jorgen Holmboe正在加州大学洛杉矶分校建立气象系。Sverdrup还与加州大学洛杉矶分校的物理学家建立了密切的联系，以改善SIO和加州大学洛杉矶分校的研究生教学。</p>
<p>SIO是第一家也是长期以来唯一一家提供海洋学研究生教学的美国研究机构。Sverdrup很幸运在他到达时，SIO已经拥有了几位才华横溢的年轻老师，包括Roger Revelle。1939年，另一位年轻的物理学家Munk来到SIO与Sverdrup一起学习。</p>
<h3 id="二战"><a href="#二战" class="headerlink" title="二战"></a>二战</h3><p>Harald Sverdrup作为SIO所长的三年任期到了，但这时挪威已经被占领。当他意识到自己将无限期地留在拉霍亚时，他决定成为美国公民。其他说法表明，他在战争期间的安全许可问题也是一个推动因素。他的战时工作需要高度保密，而且由于他的大部分家人仍留在被占领的挪威，他的许可被间歇性地取消和更新。尽管当时在海军服役的Roger Revelle努力使Sverdrup的安全状态正常化，但还是发生了一些情况。</p>
<p>战争一开始，美国军方就对海洋学家和气象学家提出了紧急要求。反潜战成为军方的重中之重，加利福尼亚大学战争研究部（UCDWR ）成立了海军无线电和声学实验室，以开展该主题的研究。<strong>SIO很快将自己转变为战时海洋学研究中心</strong>。</p>
<p>可能是因为他的外国人身份，Sverdrup与加州大学战争研究部UCDWR的水下声学工作没有直接联系。UCDWR由物理学家Gaylord P. Harnwell指导，他后来成为宾夕法尼亚大学的杰出校长，并着有出色的电学和磁学成果。Sverdrup致力于解决与预测海滩阵地海浪条件相关的一系列问题，他的海流和海浪预测方法被用来指导盟军诺曼底登陆。这项工作为海军挽救了许多生命。</p>
<p>在战后，Sverdrup讨论他的二战相关工作的价值时，表现出很大的谦逊。虽然这些成就具有重要的实际意义，但他指出它们是基于非常古老的波浪定理，并取自经典流体动力学。在阅读他现有的信件时，无论在何种情况下，他的语气都非常平稳，这让人感到震惊。这种内在的平静的心态，可能是他在逆境中以及相对较短的时间内取得如此多成就的原因。 Sverdrup认为<strong>耐力是挪威人与生俱来的特质</strong>，因为他们“在一个人烟稀少的崎岖国家长大…变得自力更生、足智多谋，具备了忍受单调、寂寞和每天辛勤劳作的气质。” </p>
<p>战时和战后一段时间对于海洋学来说是非常重要的时期。海军各部门通过直接资助和成立<strong>海军研究办公室（Office of Naval Research）</strong>在推进该领域发挥了至关重要的作用，这为美国日后取得的巨大科学成就奠定了行政基础。有故事甚至说，<strong>海军支持</strong>实际上使SIO在战争结束后免于解散。事实上，加州大学的董事会认为战争结束后SIO不再有继续存在的理由，<strong>海军对此不以为然，并直接与学校高层接洽，承诺“只要预算可行”就在财政上支持SIO</strong>。Edward Cochrane海军上将在Roger Revelle的敦促下，写信给加州大学校长Sproul，表示将继续支持SIO的战后海洋学研究。</p>
<p><strong>持续的海军资助至关重要，并发挥了重要作用。</strong>SIO和海军建立了合作关系，奠定了SIO在该领域的世界领先地位。这是一个富有成果的伙伴关系，大大加强了海军和学术界的联系。海军还做出了一项具体承诺，<strong>将无限期地支持SIO的几个教授，并提供持续的研究资金</strong>。</p>
<p>SIO的一个教授职位让Carl Eckart（美国物理学家、物理海洋学家，UCDWR主任）留下，当时Carl Eckart在UCDWR度过了战争时期，并准备重返芝加哥大学担任教授。由于UCDWR在战争结束后解散，因此必须迅速做出选择，而Sverdrup已准备邀请他留在SIO。在那些年里，Eckart是SIO最重要的成员之一，仅次于Sverdrup。</p>
<p>在战后海洋学发展过程中，Sverdrup是西海岸的核心人物。Sverdrup为SIO制定的战后计划包含许多要素。他想培训更多的海洋学家，扩大SIO研究船队，并将人力和船只集中在一个共同的科学研究计划上，从而使SIO可以出海调查并解决基本的海洋学问题。 </p>
<h3 id="离开"><a href="#离开" class="headerlink" title="离开"></a>离开</h3><p>Sverdrup于1948年离开SIO返回挪威。他给出的理由是，他可以在一个较小国家的国际事务中发挥更大的影响力。但可能还有其他原因，当时加州大学的工资是出了名的低。其次毫无疑问Harald Sverdrup和他的妻子Gudrun都想家了。</p>
<p>Sverdrup回到奥斯陆后，领导了<strong>挪威极地研究所</strong>。通过安排1949-52年的挪威-英国-瑞典探险队到南极洲，<strong>他恢复了他早期的极地探索工作</strong>。他还从1949年起担任奥斯陆大学地球物理学教授直至去世。</p>
<p>Sverdrup在挪威极地研究所的工作没有SIO的工作强度或深度，但他实现了在国际社会发挥作用的目标。</p>
<p>他于1957年8月21日突然去世。</p>
<p>关于Harald Sverdrup的去世，有几种不同的说法。他的一名学生说，就在医生说他身体状况良好时，他心脏病发作死亡，也有人说他在参加会议时去世了。</p>
<p><img src="./images/sv5.png" alt></p>
<center><font face="黑体" size="3" color="gold">图：Maud在北极。</font></center>
<center><font face="黑体" size="3" color="gold">插图创造者：Baby的小肉手</font></center>
<center><font face="黑体" size="3" color="red">算法提供：Disco Diffusion v5.2</font></center>
<center><font face="黑体" size="3" color="gray">"A beautiful painting of  polar expedition to the Arctic on R/V Maud", "blue color scheme"</font></center>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2022/06/11/gender/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="Yang Lei">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/11/gender/" class="post-title-link" itemprop="url">海洋科学中的性别平等研究</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-06-11 09:14:47 / 修改时间：18:03:59" itemprop="dateCreated datePublished" datetime="2022-06-11T09:14:47+08:00">2022-06-11</time>
            </span>

          
            <span id="/2022/06/11/gender/" class="post-meta-item leancloud_visitors" data-flag-title="海洋科学中的性别平等研究" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/06/11/gender/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/06/11/gender/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>基于<strong>联合国海洋科学促进可持续发展十年</strong>（United Nations Decade of Ocean Science for Sustainable Development）和<strong>为联合国海洋科学促进可持续发展十年赋予妇女权力</strong>（Empowering Women for the Ocean Decade Programme）项目，本文对海洋科学过去几十年性别平等进展做了研究。</p>
<p>文章第一作者Sonya Legg 一直是<strong>关系物理海洋女性博士就业和发展(MPOWIR)</strong>的联合首席研究员，现任世界气候研究计划<strong>CLIVAR</strong>项目科学指导小组的联合主席。 </p>
<blockquote>
<p>原文：<a href="https://eartharxiv.org/repository/view/3357/" target="_blank" rel="noopener">https://eartharxiv.org/repository/view/3357/</a></p>
</blockquote>
<h2 id="历史问题"><a href="#历史问题" class="headerlink" title="历史问题"></a>历史问题</h2><p>历史上，有许多阻碍女性参与海洋学的障碍。其中一些在其他领域很常见，例如工作和家庭协调的障碍、强调师承关系的晋升结构等。这里，主要关注海洋学特有的障碍。</p>
<p><img src="./images/wm1.png" alt></p>
<h3 id="禁止出海"><a href="#禁止出海" class="headerlink" title="禁止出海"></a>禁止出海</h3><p>在西欧和北美，由于长期存在的封建迷信思想，往往禁止女性上船工作。尽管如此，在英国和美国还是有少数女性参与出海调查，但主要是短期沿海任务。作为对比，在苏联，特别是北极海洋学研究考察航次，则大力支持女性参与海洋学调查。</p>
<p>美国在二战期间和之后，女性参与远海调查受到了更多限制，例如SIO海洋研究所正式禁止女性登船，这归因于SIO与美国海军之间的关系强化，拉蒙特地质观测站和WHIO (WHOI) 也有类似的限制。在1950年代，WHOI研究生罗伯塔·艾克认为，出海调查对她的职业生涯很重要。虽然WHOI的许多男性海洋学家愿意让女性出海，但他们表示前提是“船更大、更舒适”。1956年，艾克厌倦了等待，并藏匿在一艘研究船上，导致她被WHOI解雇，结束了她的海洋学生涯。</p>
<p>1963年SIO的R/V Argo航次促使制度变化，两名苏联科学家加入其中，其中一名是女性地球物理学家埃琳娜·卢比莫娃。从那时起，SIO允许女性出海，伍兹霍尔也是如此。而拉蒙特第一次允许女性上船时间在1965年。</p>
<p>尽管越来越多的女性出海，但调查船仍然缺乏女性基本设施，例如用于卫生产品的废物处理箱。即使在最近几年，许多船只也没有储存适合女性尺寸的防护服。</p>
<h3 id="限制教育和就业"><a href="#限制教育和就业" class="headerlink" title="限制教育和就业"></a>限制教育和就业</h3><p>女性接受海洋学教育的历史很长，如统计学家Rosa Lee在1900年代初受雇于英国海洋生物协会，Easter Ellen Cupp是首位从SIO获得博士学位的女性（1934年），Mary Sears于1933年从拉德克利夫学院获得博士学位。 然而，他们的就业经常受到性别偏见阻碍，例如Rosa Lee的公务员职位在结婚后被终止，Ellen Cupp在SIO被主任<strong>Harald Svedrup</strong>解雇，这很可能是因为她是一个女人。 <strong>反裙带关系</strong>规则还阻止与其他海洋学家结婚的女性在同一机构受雇。</p>
<p>尽管女性可以在整个20世纪获得海洋学高等教育，但她们的成功取决于男性教师是否愿意为她们提供指导。SIO在1960年代讨论过禁止招收女性博士，因为她们的失败率太高。</p>
<h3 id="降低贡献"><a href="#降低贡献" class="headerlink" title="降低贡献"></a>降低贡献</h3><p>尽管女性参与海洋学存在这些障碍，但仍有几位女性从岸上的实验室为美国海洋学做出了重要贡献，其中包括 <strong>June Pattullo（第一位获得物理海洋学博士学位的美国女性）</strong>，Mary Robinson领导了SIO的深海温度计设备发展，海军的海洋生物学Mary Sears，和制作了第一张大西洋中脊裂谷水深图的拉蒙特地图学家玛Marie Tharpe。然而，与男性同行相比，这些女性的工作往往被低估。人们往往认为这些女性海洋学家的工作是常规的和无聊的，最重要的是“非英雄式的”，因为它不涉及出海调查。</p>
<h3 id="骚扰"><a href="#骚扰" class="headerlink" title="骚扰"></a>骚扰</h3><p>女性参与出海调查的持续障碍是性骚扰。有限的海上空间使女性难以避免骚扰者。随着船只上的女性人数增加，骚扰事件也随之增加。</p>
<h2 id="进展和现状"><a href="#进展和现状" class="headerlink" title="进展和现状"></a>进展和现状</h2><h3 id="就业"><a href="#就业" class="headerlink" title="就业"></a>就业</h3><blockquote>
<p>在全球范围内，女性占海洋科研人员的39%，比自然科学整体高出约10%。但全球女性海洋科学家的比例仅比2013年的38%略有增加。</p>
</blockquote>
<p>不同国家之间存在很大差异，克罗地亚的女性海洋研究人员比例最高,为63%，日本的比例最低，为12%。其他国家的女性海洋研究人员的比例是：美国：35%，英国：43%，德国：40%，西班牙：43%，巴西：50%，南非：33%。</p>
<h3 id="PhD"><a href="#PhD" class="headerlink" title="PhD"></a>PhD</h3><p>海洋学性别平等的一个指标是博士学位数据。</p>
<p>美国国家科学基金跟踪不同科学领域的博士完成情况以及相关的人口统计数据，自2007年左右以来，美国海洋学博士的女性比例一直保持在50%左右，而1988年是30%，2000年是40%，美国在海洋学领域获得博士学位的女性比例超过了其他地球科学领域。</p>
<p>我们使用公开数据对2019-2021年中国4所不同大学的博士和硕士学位获得者的性别进行了调查，发现女性在硕士阶段的比例在38-65%之间，博士水平的40-60%。</p>
<h3 id="就业和评职称"><a href="#就业和评职称" class="headerlink" title="就业和评职称"></a>就业和评职称</h3><p>海洋学博士学位只是海洋学研究生涯的第一步。为了让女性充分为海洋学做出贡献，她们的专业知识需要得到对口的工作。从历史上看，担任海洋学教师职位的女性比例一直低于获得海洋学博士学位的女性比例预期。</p>
<p>2014年对于26所不同的美国机构的调查显示，平均40%的女教师处于助理教授级别，30%处于副教授级别，15%处于正教授级别。<strong>女性从一个职业阶段晋升到下一个职业阶段的可能性低于男性</strong>。</p>
<p>其他地方也注意到较高职称的女性人数减少：在欧洲所有自然科学领域，2016年女性占博士毕业生的近40%，但仅占教授的15%;来自法国CNRS、意大利学术界和西班牙的2021年数据均显示，女性的比例从博士水平的50%左右下降到最高学术水平（教授）的25%左右。</p>
<p>在中国也看到了类似的趋势，我们从公开数据中调查了当前（2022年初）<strong>15所不同大学</strong>海洋学系的教师人数，女性占讲师的38.1%、副教授的30.7%和教授的18.2%，在每个职业生涯的各个阶段都在下降。<strong>讲师级别的女性比例低于其中四个机构获得博士学位的女性比例，这表明女性博士找到教职工作的可能性较小。</strong>教授级别的性别差异在不同学科之间差异很大：<strong>物理海洋学教授中只有12%是女性</strong>，<strong>而海洋生物学教授中有23.2%是女性</strong>。在讲师层面，海洋生态学中女性超过男性（61.4%），物理海洋学（46.2%女性）接近平等，但在海洋地质学中仍然只占很小的比例（29.5%）。</p>
<p><img src="./images/wm2.png" alt></p>
<p>女性在领导层中的比例仍然很低，2019年只有24%的法国CNRS海洋实验室由女性领导，西班牙海洋科学研究所负责人中只有33%是女性。巴西7个海洋科学研究所中只有1个由女性领导，国家海洋和水道研究所18位高级研究人员中只有3位是一个女性。然而，在美国，6个海洋学机构中的3个任命了女性主任，表明取得了一定的进展。</p>
<p>职称晋升并不是唯一衡量标准，但这可能是其他潜在不平等的来源。WHIO进行了性别平等审查表明，在科学人员的薪酬方面存在性别不平等，男女在就业后存在差异，以及办公室空间分配方面的性别不平等，男性终身科学家拥有比女性终身科学家多约50%的办公室空间。</p>
<h3 id="经费"><a href="#经费" class="headerlink" title="经费"></a>经费</h3><p>美国许多基础研究都由<strong>国家科学基金会</strong>资助，该基金会每年都发布绩效评估。 2009 年，向女性首席研究员 (PI) 资助的成功率从 2006 年的 23% 增加到 2008 年的27% 。2019年绩效审查显示，自2009 年以来，所有 NSF 女性 PI 的资助率一直是比男性 PI 的资助率高约 1 或 2 个百分点，女性提交的提案比例从 2009 年的约 23% 略微上升到 2019 年的 29%。特别是在地球科学部，2019年26%的提案有女性PI，56%有男性PI（17%的PI的性别未知），女性PI提交的提案中有40%获得了资助，而男性 PI 提交的提案中有 37% 获得了资助。另一个促成资助率性别平等的因素可能是<strong>NSF项目管理人员的性别平衡</strong>：在整个 NSF 项目管理人员中，女性项目管理人员的比例从 2006年的36%到2019年的47%。NSF旨在确保公平公正的政策是另一个可能的因素。我们不知道其他美国海洋学资助机构（例如ONR）的类似构成，它们的评估结构非常不同。</p>
<h3 id="首席"><a href="#首席" class="headerlink" title="首席"></a>首席</h3><p>海洋学中的一个重要职位是研究船上的首席科学家或领队。在UNOLS船上，女性首席科学家的比例从 2000 年代初的 10% 增加到 2010 年代初的 20%，在德国 Polarstern研究船上从 15% 增加到 30% 。来自德国科考船的数据显示，在 2018 年和 2019 年的 255 次科学调查中，24% 的首席科学家是女性。</p>
<p>深海钻探项目 (Deep Sea Drilling Project, 1968-1983) 和大洋钻探计划 (Ocean Drilling Program,1985-2003) 表明，女性的参与率从 1970 年代的不到 10% 上升到 2000 年代初期的 25% 以上 。 DSDP 中只有 4 名女性担任联合首席科学家，而ODP则有16位 女性联合首席科学家。对于多平台综合海洋钻探计划(Integrated Ocean Drilling Program)，在 2004-2013 年期间女性平均占科学团队的 30%，但仅占联合首席科学家的 12%。IODP 对提供资金国家的联合首席科学比例家提出了要求，<strong>尽管日本是一个重要的捐助者，但没有日本女性联合首席科学家</strong>。最近，在国际海洋发现计划（International Ocean Discovery Program，2014 年至今）期间，性别平衡有所改善：在 2014 年至 2018 年期间，女性占联合首席科学家的 32%。</p>
<h3 id="发论文"><a href="#发论文" class="headerlink" title="发论文"></a>发论文</h3><p>以AGU期刊JGR:Oceans 2016-2021年数据为例。女性通讯作者的比例从2016年的21%增加到 2021 年达到 25%。 编辑邀请的审稿人中女性比例从 2016 年的 19% 稳步上升到2021年的26%。 在2017-2020年期间，女性第一作者最终被接受论文的百分比约67% 而男性第一作者约59%。<strong>女性作者在所有年份的接受率都比男性作者高几个百分点</strong>。其他AGU期刊也是如此。</p>
<h3 id="会议"><a href="#会议" class="headerlink" title="会议"></a>会议</h3><p>除了教育程度、就业和出版之外，跟踪女性对海洋学贡献的另一种方法是看看她们参与科学会议的情况。</p>
<p>IOC-UNESCO调查了2015-2018年举行的 37次国际海洋会议的参与者名单，发现 43% 的参与者是女性，但这一比例因主题而异（海洋健康领域的参与者超过50%会议是女性，在海洋生态系统会议中约占50%，在海洋地壳和海洋地质灾害会议中仅约30%），并因国籍而异（女性占俄罗斯、意大利、巴西和葡萄牙参与者的 50% 以上，而日本低于20%）。</p>
<p><strong>女性平均仅占特邀报告的29%，远低于她们的平均参与水平。</strong></p>
<h3 id="奖项"><a href="#奖项" class="headerlink" title="奖项"></a>奖项</h3><p>奖项通常由专业和学术团体颁发，是对科学家成就的重要认可。直到 21 世纪，女性海洋学家基本上都没有出现在这些荣誉榜上。</p>
<p>下表显示了21世纪以前美国地球物理联盟 (AGU)、美国气象学会 (AMS)、欧洲地球物理联盟 (EGU)、国际海洋物理科学协会 (IAPSO)、湖泊学和海洋学科学协会 (ASLO) 和海洋学学会 (TOS)授予女性的专业海洋学奖项。</p>
<table>
<thead>
<tr>
<th align="center">机构</th>
<th align="center">奖项名称</th>
<th align="center">时间段</th>
<th align="center">女性/总数</th>
<th align="center">女性比例</th>
</tr>
</thead>
<tbody><tr>
<td align="center">AGU</td>
<td align="center">Ewing Medal</td>
<td align="center">2007-2021</td>
<td align="center">4/14</td>
<td align="center">29%</td>
</tr>
<tr>
<td align="center">AGU</td>
<td align="center">Revelle Medal</td>
<td align="center">2004-2021</td>
<td align="center">6/17</td>
<td align="center">35%</td>
</tr>
<tr>
<td align="center">AGU</td>
<td align="center">Ocean Sciences Award</td>
<td align="center">2002-2021</td>
<td align="center">1/11</td>
<td align="center">9%</td>
</tr>
<tr>
<td align="center">AGU</td>
<td align="center"><strong>Ocean sciences early career award</strong></td>
<td align="center">2002-2021</td>
<td align="center">5/12</td>
<td align="center">42%</td>
</tr>
<tr>
<td align="center">AGU</td>
<td align="center">Ocean sciences voyager award</td>
<td align="center">2014-2020</td>
<td align="center">2/4</td>
<td align="center">50%</td>
</tr>
<tr>
<td align="center">AGU</td>
<td align="center">Emiliani Lecture</td>
<td align="center">2005-2021</td>
<td align="center">9/21</td>
<td align="center">33%</td>
</tr>
<tr>
<td align="center">AGU</td>
<td align="center">Svedrup Lecture</td>
<td align="center">2000-2021</td>
<td align="center">12/22</td>
<td align="center">54%</td>
</tr>
<tr>
<td align="center">AMS</td>
<td align="center">Stommel Research Medal</td>
<td align="center">2011-2022</td>
<td align="center">2/12</td>
<td align="center">16%</td>
</tr>
<tr>
<td align="center">AMS</td>
<td align="center">Svedrup Medal</td>
<td align="center">2011-2022</td>
<td align="center">2/12</td>
<td align="center">16%</td>
</tr>
<tr>
<td align="center">AMS</td>
<td align="center"><strong>Fofonoff award</strong></td>
<td align="center">2011-2022</td>
<td align="center">5/12</td>
<td align="center">42%</td>
</tr>
<tr>
<td align="center">EGU</td>
<td align="center">Nansen medal</td>
<td align="center">2011-2022</td>
<td align="center">3/12</td>
<td align="center">25%</td>
</tr>
<tr>
<td align="center">EGU</td>
<td align="center"><strong>Ocean div. early career award</strong></td>
<td align="center">2011-2022</td>
<td align="center">3/8</td>
<td align="center">38%</td>
</tr>
<tr>
<td align="center">IAPSO</td>
<td align="center">Prince Albert medal</td>
<td align="center">2000-2021</td>
<td align="center">2/11</td>
<td align="center">18%</td>
</tr>
<tr>
<td align="center">IAPSO</td>
<td align="center"><strong>Eugene LaFond medal</strong></td>
<td align="center">2003-2019</td>
<td align="center">5/9</td>
<td align="center">55%</td>
</tr>
<tr>
<td align="center">IAPSO</td>
<td align="center"><strong>early career scientist medal</strong></td>
<td align="center">2019-2021</td>
<td align="center">2/4</td>
<td align="center">50%</td>
</tr>
<tr>
<td align="center">ASLO</td>
<td align="center"><strong>Lindemann Award</strong></td>
<td align="center">2000-2021</td>
<td align="center">10/22</td>
<td align="center">45%</td>
</tr>
<tr>
<td align="center">ASLO</td>
<td align="center">Hutchinson Award</td>
<td align="center">2010-2021</td>
<td align="center">3/12</td>
<td align="center">25%</td>
</tr>
<tr>
<td align="center">ASLO</td>
<td align="center">Redfield lifetime achievement award</td>
<td align="center">2015-2021</td>
<td align="center">3/8</td>
<td align="center">38%</td>
</tr>
<tr>
<td align="center">ASLO</td>
<td align="center"><strong>Yentsch-Schindler early career award</strong></td>
<td align="center">2013-2022</td>
<td align="center">4/10</td>
<td align="center">40%</td>
</tr>
<tr>
<td align="center">TOS</td>
<td align="center">Munk Medal</td>
<td align="center">1993-2017</td>
<td align="center">1/13</td>
<td align="center">8%</td>
</tr>
<tr>
<td align="center">TOS</td>
<td align="center">Jerlov award</td>
<td align="center">2000-2020</td>
<td align="center">1/11</td>
<td align="center">9%</td>
</tr>
</tbody></table>
<p>在早期职业类型奖励中（AGU 海洋科学早期职业奖、AMS Fofonoff 奖、EGU 海洋部早期职业奖、IAPSO Eugene LaFond 和早期职业科学家奖章、ASLO Lindemann 和 Yentsch-Schindler 奖）性别平等尤为明显，女性占到了38-55%。 </p>
<p>AGU 海洋科学航海者（职业生涯中期）奖获得者中有 50% 是女性，而 AGU 的Emiliani 和 Svedrup 奖项越来越多地授予女性。</p>
<p>对于高级奖项，性别比例是多变的。虽然 AGU Maurice Ewing 和 Roger Revelle奖自2014年以来提高了她们的性别比例，但AGU海洋科学奖（奖励高级海洋学家）仅授予一名女性。ASLO Redfield自 2015 年以来，8 个奖项中有 3 个授予女性成就奖。AMS（Stommel 和 Svedrup）和 IAPSO（Prince Albert medal）的高级海洋学奖很少授予女性，而历史悠久的两个 TOS 高级奖项（ Munk Medal 和 Nils Gunnar Jerlov 奖）均只授予女性一次。</p>
<h3 id="委员会、董事会、小组"><a href="#委员会、董事会、小组" class="headerlink" title="委员会、董事会、小组"></a>委员会、董事会、小组</h3><p>海洋学界对女性的包容和认可的另一个指标是她们在领导职位中的代表性，如董事会、委员会和小组。</p>
<p>调查发现女性占<strong>沿海地球科学和工程专业组</strong>成员的30%左右。然而，<strong>沿海地球科学和工程国际会议</strong>的组委会中只有22%是女性。相比之下，在关注海洋在气候中的作用的世界气候研究计划 <strong>CLIVAR</strong>项目中，女性目前占其小组成员的44%。</p>
<p>海洋学专业协会的主席是最高级别领导职位。从 1989 年到 2010 年，海洋学会只有 2/10 的女性主席，而从 2010 年到 2022 年，2/6 的主席是女性。 AGU 的海洋科学部在 1988 年首次有一名女主席，从 1990 年到 2022 年有 6/15 名女主席，自 2010 年以来有 3/5 名女主席。 ASLO 于 1988 年首次有女一把手，从 1990 年到2022年有 6/16 位女一把手，其中自 2010 年以来有 3/6 位。最后，自 2010 年以来，IAPSO 自1919年的整个历史中只有2位女一把手，还是21世纪后提名的。</p>
<h2 id="措施"><a href="#措施" class="headerlink" title="措施"></a>措施</h2><h3 id="数据采集"><a href="#数据采集" class="headerlink" title="数据采集"></a>数据采集</h3><p>如果没有海洋学活动所有参与者的完整性别分类数据，就无法准确识别参与的性别障碍。</p>
<p>“为联合国海洋科学可持续发展十年赋予妇女权力”计划已开始从选定的国际组织和国家机构收集数据。** Baltic Consortium on Promoting Gender Equality in Marine Research Organizations (Baltic Gender) ** 项目与来自波罗的海地区5个国家的8个机构合作，制定了一套13项性别敏感指标，包括性别薪酬差距、就业指数、研究航次中女性和男性首席科学家的比例、董事会和委员会中女性的比例、女性和男性工作申请、面试和录用的比例。</p>
<h3 id="体制变革"><a href="#体制变革" class="headerlink" title="体制变革"></a>体制变革</h3><p>目前已经制定了几项举措来促进机构变革，目标是在学术和科研机构的教职员工/首席研究员层面实现性别平等。例子包括美国的NSF ADVANCE计划和英国的Athena SWAN计划。</p>
<h3 id="互联网"><a href="#互联网" class="headerlink" title="互联网"></a>互联网</h3><p>在学术和研究机构之外，为基于性别平等提供网络支持。包括海科女性协会、地科女网 (<a href="https://eswnonline.org/)、沿海地科女网" target="_blank" rel="noopener">https://eswnonline.org/)、沿海地科女网</a> ( <a href="http://womenincoastal.org/" target="_blank" rel="noopener">http://womenincoastal.org/</a> )、海女网（ <a href="https://womenforoneocean.com/" target="_blank" rel="noopener">https://womenforoneocean.com/</a> ）和海洋黑人网（ <a href="https://www.blackinmarinescience.org/" target="_blank" rel="noopener">https://www.blackinmarinescience.org/</a> ）。</p>
<p><img src="./images/wm3.png" alt></p>
<h3 id="骚扰问题"><a href="#骚扰问题" class="headerlink" title="骚扰问题"></a>骚扰问题</h3><p>如果不解决陆上和船上工作环境中的性骚扰问题，将无法实现性别公平的目标。解决这个问题需要制度变革，而不仅仅是事后惩罚个别肇事者。最近的促进野外科学安全研讨会提供了一长串建议，包括文化变革、问责制、政策制定等，强调了处理海上骚扰。自2019年以来，UNOLS设立了一个关于维护尊重船上环境的常设委员会。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p>调查显示，在许多国家，女性在海洋学本科和研究生教育中的比例接近平等，并且在早期就业水平中的平等程度正在提高。因此，女性对海洋学并不缺乏兴趣。</p>
</li>
<li><p>虽然女性第一作者和 PI 的比例尚未与女性海洋学博士的比例相匹配，但在某些资助计划中，女性 PI 的提案与男性 PI 的提案一样可能得到资助。</p>
</li>
<li><p>不同组织在奖项性别比例方面的改善差异很大，女性在小组和委员会中的代表性也是如此。不同组织之间的差异可能反映了不同的选择过程，其中一些可能更容易受到结构和认知偏见的影响。</p>
</li>
<li><p>海洋学分支学科之间的性别平等仍然存在差异，<strong>女性参与物理海洋学的人数少于生物海洋学</strong>。</p>
</li>
</ul>
<p>然而，这些在最广泛层面上的性别平等掩盖了女性群体持续存在的不平等现象。海洋学中真正的性别平等必须包括女性在所有生命阶段、社会经济背景、种族、性取向和身体能力方面的参与。性别平等还必须包括所有性别的跨性别者，他们面临性别歧视和骚扰以及制度障碍。</p>
<p><img src="./images/wm4.png" alt></p>
<center><font face="黑体" size="3" color="gold">女孩们在北极探险</font></center>
<center><font face="黑体" size="3" color="gold">插图创造者：Baby的小肉手</font></center>
<center><font face="黑体" size="3" color="red">算法提供：Disco Diffusion v5.2</font></center>
<center><font face="黑体" size="3" color="gray">"A nice painting of a group girls exploring the arctic ocean,  by Pride & Prejudice", "blue color scheme"</font></center>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yang Lei"
      src="/images/xingchi.jpg">
  <p class="site-author-name" itemprop="name">Yang Lei</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">142</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">83</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://getmyte.com/" title="https:&#x2F;&#x2F;getmyte.com&#x2F;" rel="noopener" target="_blank">getmyte</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.economist.com/" title="https:&#x2F;&#x2F;www.economist.com&#x2F;" rel="noopener" target="_blank">Economist</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://l7.antv.vision/en/" title="https:&#x2F;&#x2F;l7.antv.vision&#x2F;en&#x2F;" rel="noopener" target="_blank">AntV</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yang Lei</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.0
  </div>

        






  <script>
  function leancloudSelector(url) {
    url = encodeURI(url);
    return document.getElementById(url).querySelector('.leancloud-visitors-count');
  }
  if (CONFIG.page.isPost) {
    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.getAttribute('id'));
      var title = visitors.getAttribute('data-flag-title');

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .then(response => response.json())
              .then(() => {
                leancloudSelector(url).innerText = counter.time + 1;
              })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              })
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  } else {
    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.getAttribute('id'));
      });

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url: { '$in': entries } })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length === 0) {
            document.querySelectorAll('.leancloud_visitors .leancloud-visitors-count').forEach(element => {
              element.innerText = 0;
            });
            return;
          }
          for (let item of results) {
            let { url, time } = item;
            leancloudSelector(url).innerText = time;
          }
          for (let url of entries) {
            var element = leancloudSelector(url);
            if (element.innerText == '') {
              element.innerText = 0;
            }
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  }

  fetch('https://app-router.leancloud.cn/2/route?appId=a05sUJqbxBXDbnppdO8OVgiC-gzGzoHsz')
    .then(response => response.json())
    .then(({ api_server }) => {
      var Counter = (method, url, data) => {
        return fetch(`https://${api_server}/1.1${url}`, {
          method: method,
          headers: {
            'X-LC-Id': 'a05sUJqbxBXDbnppdO8OVgiC-gzGzoHsz',
            'X-LC-Key': 'YRcXfwqMVEWtFfgTumCdt2il',
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    });
  </script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el: '#valine-comments',
      verify: false,
      notify: false,
      appId: 'a05sUJqbxBXDbnppdO8OVgiC-gzGzoHsz',
      appKey: 'YRcXfwqMVEWtFfgTumCdt2il',
      placeholder: "Just go go",
      avatar: 'mm',
      meta: guest,
      pageSize: '10' || 10,
      visitor: false,
      lang: 'zh-cn' || 'zh-cn',
      path: location.pathname,
      recordIP: false,
      serverURLs: ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
